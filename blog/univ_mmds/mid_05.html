<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>웅덩이</title><link rel="canonical" href="https://wjlee611.github.io/blog/univ_mmds/mid_05"/><meta name="next-head-count" content="4"/><link rel="icon" href="/images/icon_circle.png"/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" rel="stylesheet"/><meta name="description" content="웅덩이"/><meta name="apple-mobile-web-app-title" content="웅덩이"/><meta name="application-name" content="웅덩이"/><meta name="theme-color" content="#009c39"/><meta name="google-site-verification" content="vhQ9DaDdUJcSBHKI_U6tAtE61zwz2i2pLQXyZ62GRLk"/><meta name="naver-site-verification" content="07764cc1a8eda55b4bdf78cf846d6811d042b9ee"/><link rel="preload" href="/_next/static/media/a37cf3809adb2c63-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/dd50543ba70be8e9-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/c372a630cbda84f2-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/c244cd6be2a69a75.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c244cd6be2a69a75.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-401a9806b070f31a.js" defer=""></script><script src="/_next/static/chunks/main-6b74302918225334.js" defer=""></script><script src="/_next/static/chunks/pages/_app-01dc60c7ef7ccbd8.js" defer=""></script><script src="/_next/static/chunks/95b64a6e-5c1c80ce1af5e491.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...slugs%5D-d30256c1e19801d0.js" defer=""></script><script src="/_next/static/rqj0U5_GhQD4-JilT3-oa/_buildManifest.js" defer=""></script><script src="/_next/static/rqj0U5_GhQD4-JilT3-oa/_ssgManifest.js" defer=""></script></head><body class="text-primary transition-[background] bg-white dark:bg-[#1A1C23]"><script>
            const theme = localStorage.getItem("theme");
            const getUserTheme = () => {
             if(theme){
              return theme
             } 
             return window.matchMedia('(prefers-color-scheme: dark)').matches
             ? 'dark'
             : 'light'
          }
          document.body.dataset.theme = getUserTheme();
          </script><div id="__next"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="__className_e7b8b0 text-center transition-all "><header class="fixed top-0 left-0 right-0 mx-anuo w-screen h-12 md:h-16 flex justify-between items-center px-2 md:px-10 backdrop-blur bg-blue-200 bg-opacity-20 z-50"><div class="h-full flex items-center"><a class="h-full aspect-square flex justify-center items-center text-3xl select-none cursor-pointer" href="/">🫧</a><nav class="h-full hidden md:flex space-x-8 overflow-hidden ml-10"><li class="h-full flex items-center list-none relative select-none"><a class="h-full w-full md:w-auto flex items-center transition-colors py-2 md:my-0 font-bold text-black dark:text-white " href="/">Portfolio</a></li><li class="h-full flex items-center list-none relative select-none"><a class="h-full w-full md:w-auto flex items-center transition-colors py-2 md:my-0 font-bold text-blue-500 " href="/blog">Blog</a><div class="hidden md:flex w-full h-[2px] bg-blue-500 absolute bottom-0 left-0 blur-[2px]"></div></li><li class="h-full flex items-center list-none relative select-none"><a class="h-full w-full md:w-auto flex items-center transition-colors py-2 md:my-0 font-bold text-black dark:text-white " href="/arkhive">Arkhive</a></li></nav></div><div class="flex items-center h-full"><button aria-label="Toggle Dark Mode" type="button" class="flex h-9 w-9 items-center justify-center rounded-lg transition-all text-secondary hover:bg-secondary "><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="h-6 w-6 text-yellow-400 drop-shadow-base"></svg></button><button class="flex md:hidden items-center justify-center w-16 h-full text-2xl text-black dark:text-white"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.5 11.5A.5.5 0 0 1 5 11h10a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5zm-2-4A.5.5 0 0 1 3 7h10a.5.5 0 0 1 0 1H3a.5.5 0 0 1-.5-.5zm-2-4A.5.5 0 0 1 1 3h10a.5.5 0 0 1 0 1H1a.5.5 0 0 1-.5-.5z"></path></svg></button></div></header><main class="inline-block w-full relative pt-16 px-8 max-w-5xl 2xl:max-w-7xl" style="opacity:1;transform:none"><div class="flex flex-col items-start pb-16"><header class="flex w-full flex-col items-center my-10"><h1 class="bg-gradient-to-br from-blue-600 to-blue-400 bg-clip-text text-transparent text-3xl font-bold mb-5 drop-shadow">Finding Similar Items</h1><span class="text-blue-500 text-lg">유사도 높은 문서를 찾아내는 방법을 알아봅니다.</span><span class="space-x-10 mt-5 text-blue-400 text-sm">읽는데<span class="text-blue-500 text-xl font-semibold"> <!-- -->11</span>분 정도 걸려요.</span></header><section class="w-full flex justify-between space-x-5"><div class="w-full flex flex-col items-start prose dark:prose-dark max-w-full lg:max-w-2xl 2xl:max-w-4xl"><p>생김새가 비슷한 사이트를 묶거나, 표절 검사를 하거나, 비슷한 내용의 뉴스를 클러스터링 하는 등 여러 분야에서 사용될 수 있는 기술에 대해 설명합니다.</p>
<notice><p>생김새가 비슷한 문서를 찾아내는 기술이지, 비슷한 토픽을 찾아내는 기술은 아닙니다.</p></notice>
<p>아래의 단계를 거쳐 비슷한 문서를 찾게 되는데, 각 단계에 대한 세부적인 내용은 추후에 설명합니다.</p>
<ol>
<li><code>Shingling</code>을 통해 데이터(문서)를 집합으로 변환</li>
<li><code>Minhashing</code>을 통해 큰 집합을 작은 시그니처로 변환</li>
<li><code>LSH</code>를 통해 시그니처를 분류 후 비슷한 집합 찾기</li>
</ol>
<h2 id="jaccard-similarity"><a class="anchor" href="#jaccard-similarity"><span class="icon icon-link"></span></a>Jaccard Similarity</h2>
<p>세부내용 설명 전 개념 하나만 짚고 넘어가자.<br/>
<!-- -->유사도를 검사할 때, 다음과 같은 경우를 고려해보자.</p>
<p>A, B 모두 메이져한 게임들을 주로 플레이하고, A는 RPG를, B는 FPS를 주로 플레이한다고 가정하자.<br/>
<!-- -->이 때, 마이너한 장르의 게임을 예시로 들며 유사도를 검사하는데, A, B 모두 해당 게임을 보유하지 않는다고 두 사람의 유사도가 높다고 이야기 할 수 있을까?<br/>
<!-- -->두 사람은 그런 마이너한 장르의 게임에 관심이 없어서 갖고있지 않을 뿐인데, 둘 다 갖고있지 않다고 두 사람의 플레이스타일이 유사하다고 판단하는 것은 무리가 있다.</p>
<p>따라서 이런 유사도 파악의 오류를 해결하기 위해 Jaccard 유사도를 사용하여 유사도를 측정하게 된다.</p>
<div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>S</mi><mi>i</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>C</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>C</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∣</mi><msub><mi>C</mi><mn>1</mn></msub><mo>∩</mo><msub><mi>C</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi></mrow><mrow><mi mathvariant="normal">∣</mi><msub><mi>C</mi><mn>1</mn></msub><mo>∪</mo><msub><mi>C</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">Sim(C_1, C_2) = \frac{|C_1 \cap C_2|}{|C_1 \cup C_2|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord mathnormal">im</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∣</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></div>
<p>즉, <strong>두 사람 중 한 사람이라도 해당 게임을 보유하고 있는 경우에만 두 사람이 동시에 해당 게임을 보유하는가</strong>로 유사도를 검사하는 것이다.</p>
<hr/>
<h2 id="shingling"><a class="anchor" href="#shingling"><span class="icon icon-link"></span></a>Shingling</h2>
<p>문서의 유사도를 측정할 때 그 기준이 되는 토큰을 생성하는 방법입니다.<br/>
<code>k-shingle</code> 과 같은 용어를 사용하는데, 이는 k개의 문자로 이루어진 shingle을 의미합니다.<br/>
<!-- -->실제로 비슷한 문서를 싱글링 했을 때 집합의 원소도 일치하는 부분이 매우 많습니다.</p>
<p>예로 들어 &quot;The dog which chased the cat&quot; 이라는 문장이 있다고 했을 때, 여기서 2-shingle를 구하면 다음과 같습니다.</p>
<blockquote>
<p>th(보통 소문자로 변환), he, e_, _d, do, og, ...</p>
</blockquote>
<p>하지만, 2-shingle로 하면 th, he, do와 같이 문장으로 볼 때는 상당히 유니크한 의미를 갖는 문장이 이렇게 아무데서나 나올법한 shingle이 되어버립니다.<br/>
<!-- -->따라서 보통은 <code>8~10</code>-shingle로 하는 것이 적당합니다.</p>
<h3 id="tokens"><a class="anchor" href="#tokens"><span class="icon icon-link"></span></a>Tokens</h3>
<p>10-shingle을 사용하는 경우에는 최대 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><msup><mn>7</mn><mn>10</mn></msup><mo>≈</mo><mn>200</mn><mtext>조</mtext></mrow><annotation encoding="application/x-tex">27^{10} \approx 200조</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord">2</span><span class="mord"><span class="mord">7</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">10</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">200</span><span class="mord hangul_fallback">조</span></span></span></span></span> 개의 싱글이 생성되게 됩니다.<br/>
<!-- -->이를 메모리상에서 관리하는 것은 현실적으로 불가능한 일입니다.</p>
<p>따라서 싱글을 해싱하여 4bytes의 자료형으로 변환하여 <code>Token</code>으로서 사용하게 됩니다.<br/>
<!-- -->4bytes로 최대 약 42억개의 서로 다른 싱글을 표현할 수 있습니다.<br/>
<!-- -->물론 다른 싱글에 대해 같은 토큰이 생성될 수 있지만, 그리 빈번한 경우는 아닐 것이며, 효율상 이 방법이 더 좋습니다.</p>
<p>즉, 같은 토큰을 보유한 문서가 있다면, 그 문서들은 같은 싱글을 갖고있다는 얘기이므로, 유사도가 있다고 판단할 수 있겠습니다.</p>
<hr/>
<h2 id="minhashing"><a class="anchor" href="#minhashing"><span class="icon icon-link"></span></a>Minhashing</h2>
<p>Minhashing을 알아보기 전, 데이터를 표현하는 행렬을 읽는 법을 알고가자.</p>
<table><thead><tr><th>(token)</th><th><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">C_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></th><th><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">C_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td>a</td><td>0</td><td>0</td></tr><tr><td>b</td><td>1</td><td>0</td></tr><tr><td>c</td><td>0</td><td>1</td></tr><tr><td>d</td><td>1</td><td>1</td></tr></tbody></table>
<p>a 토큰(싱글)은 문서(Column) 1, 2에서 모두 없다는 뜻이고, b는 문서 1에서만 갖고있다는 뜻으로 해석하면 된다.<br/>
<!-- -->참고로 위의 경우 두 문서의 Jaccard 유사도는 <strong>1/3</strong>이다. (a는 둘 다 없기에 비교대상이 아니다)</p>
<h3 id="permute-the-rows"><a class="anchor" href="#permute-the-rows"><span class="icon icon-link"></span></a>Permute the rows</h3>
<p>우선 행을 핸덤으로 뒤죽박죽 섞는다.<br/>
<!-- -->섞는다는 것은 실제로 맊 섞는다는 것이 아닌, 탐색 순서를 섞는다는 것을 의미하는데, 구현 관점에서 해싱을 돌리는 것과 같다.<br/>
<!-- -->예시를 보며 이해해보자.</p>
<table><thead><tr><th>(row)</th><th><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">C_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></th><th><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">C_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></th><th><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">C_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></th></tr></thead><tbody><tr><td>1</td><td>0</td><td>1</td><td>1</td></tr><tr><td>2</td><td>1</td><td>0</td><td>1</td></tr><tr><td>3</td><td>0</td><td>1</td><td>0</td></tr><tr><td>4</td><td>0</td><td>0</td><td>0</td></tr><tr><td>5</td><td>1</td><td>0</td><td>1</td></tr></tbody></table>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>x</mi><mi mathvariant="normal">%</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">h_1(x) = x \% 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em"></span><span class="mord mathnormal">x</span><span class="mord">%5</span></span></span></span></span> 해시함수를 적용하면 탐색 순서는 다음과 같아진다.</p>
<blockquote>
<p><strong>5</strong>(0) → <strong>1</strong>(1) → <strong>2</strong>(2) → <strong>3</strong>(3) → <strong>4</strong>(4)</p>
</blockquote>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mi>x</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">%</mi><mn>5</mn></mrow><annotation encoding="application/x-tex">h_2(x) = (2x+1) \% 5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord">%5</span></span></span></span></span> 해시함수를 적용하면 탐색 순서는 다음과 같아진다.</p>
<blockquote>
<p><strong>2</strong>(0) → <strong>5</strong>(1) → <strong>3</strong>(2) → <strong>1</strong>(3) → <strong>4</strong>(4)</p>
</blockquote>
<h3 id="create-signature"><a class="anchor" href="#create-signature"><span class="icon icon-link"></span></a>Create signature</h3>
<p>탐색 순서에 맞게 처음으로 1(토큰 보유)을 만나는 탐색 순서를 기록한다.</p>
<blockquote>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">h_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>를 적용한 탐색시 생성되는 Singature matrix<br/>
<!-- -->[1, 2, 1]</p>
<p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">h_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>를 적용한 탐색시 생성되는 Singature matrix<br/>
<!-- -->[1, 3, 1]</p>
</blockquote>
<p>즉, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">C_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>에 대한 시그니처는 11, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">C_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>는 23, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">C_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>은 11이 된다.</p>
<p>여기서 중요한 특징이 있는데, 시그니처의 길이가 길어질 수록(무작위 순서에 의한 탐색 횟수가 늘어날 수록) 시그니처가 일치할 확률이 Jaccard 유사도와 확률이 같아진다.<br/>
<!-- -->그 이유를 간단한 예시로 이해해보자.</p>
<p>우선, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">C_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>과 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">C_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>의 Jaccard 유사도는 <strong>1/4</strong>이다.<br/>
<!-- -->그런데 이 때, Singature가 같아지는 경우는 무엇일까? 바로 <strong>최초로 1이 나오는 시점이 같다</strong>는 이야기이다.<br/>
<!-- -->즉, 같은 row에 대해 둘 다 1이 들어가 있는 row를 고를 확률과 같아진다.<br/>
<!-- -->둘 다 0인 경우를 제외하면 4개 중에 둘 다 1인 row는 1개 존재하기에 Jaccard 유사도와 동일한 <strong>1/4</strong> 확률을 갖는다.</p>
<p><img src="/posts/mid_05/231020-235719.png" alt="231020-235719"/></p>
<p>이해를 돕기 위해 다른 예시도 보자.</p>
<p>원래대로라면 생성되는 모든 토큰(42억개)에 대해 유사도를 검사 했어야 했다.<br/>
<!-- -->하지만, 시그니처를 만드는 과정에서 무작위 순서로 탐색을 진핼할 때, 탐색개수를 제한을 걸면 검사 시간을 줄일 수 있다.<br/>
<!-- -->예로 들어 해시함수의 결과를 50까지만 검색한다면 42억개의 항목에 대해 검사를 진행하지 않아도 된다.</p>
<p>이 때 검사 개수를 줄인 만큼 서로다른 해시를 여러 번 진행하면 신뢰도 역시 어느정도 확보할 수 있다.<br/>
<!-- -->예로 들어 서로 다른 해시함수 100개를 적용한다면, 시그니처의 길이가 100으로 결정되는데, 이 길이는 충분히 신뢰도를 확보할 수 있을 것이다.<br/>
<!-- -->즉, 42억개에서 100개로 압축되는 효과가 발생하는 것이다.</p>
<p>위의 사진을 예시로 실제 Jaccard 유사도와 시그니처 유사도를 비교해보며 시그니처 길이가 신뢰도에 어느정도 영향을 주는지 알아보자.</p>
<blockquote>
<p>Column 1, 2<br/>
<!-- -->Jaccard Similarity: <strong>1/4</strong><br/>
<!-- -->Singature Similarity: <strong>1/3</strong></p>
<p>Column 2, 3<br/>
<!-- -->Jaccard Similarity: <strong>1/5</strong><br/>
<!-- -->Singature Similarity: <strong>1/3</strong></p>
<p>Column 3, 4<br/>
<!-- -->Jaccard Similarity: <strong>1/5</strong><br/>
<!-- -->Singature Similarity: <strong>0</strong></p>
</blockquote>
<h3 id="implement"><a class="anchor" href="#implement"><span class="icon icon-link"></span></a>implement</h3>
<p>의사코드로 구현해보고 시그니처 생성과정을 살펴보자.</p>
<div class="rehype-code-title">의사코드</div><pre class="language-cpp"><code class="language-cpp code-highlight"><span class="code-line"><span class="token comment">// 처음에 무한대로 초기화</span>
</span><span class="code-line"><span class="token keyword">for</span> <span class="token punctuation">(</span>all i <span class="token operator">and</span> c<span class="token punctuation">)</span> <span class="token function">M</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=</span> inf<span class="token punctuation">;</span>
</span><span class="code-line">
</span><span class="code-line"><span class="token comment">// 각 행에 대해 반복하는데, 여기에 탐색개수 50개와 같은 제한을 걸 수 있음</span>
</span><span class="code-line"><span class="token keyword">for</span> <span class="token punctuation">(</span>each row r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">  <span class="token keyword">for</span> <span class="token punctuation">(</span>each hash function h_i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    compute <span class="token function">h_i</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token keyword">for</span> <span class="token punctuation">(</span>each column c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">    <span class="token comment">// 탐색지점에 1이 있는 경우</span>
</span><span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>c has <span class="token number">1</span> in row r<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">      <span class="token keyword">for</span> <span class="token punctuation">(</span>each hash function h_1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">        <span class="token comment">// 저장된 시그니처보다 새 탐색값이 작은 경우에만 업데이트</span>
</span><span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">h_i</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span> is smaller them <span class="token function">M</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line">          <span class="token function">M</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">h_i</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">        <span class="token punctuation">}</span>
</span><span class="code-line">      <span class="token punctuation">}</span>
</span><span class="code-line">    <span class="token punctuation">}</span>
</span><span class="code-line">  <span class="token punctuation">}</span>
</span><span class="code-line"><span class="token punctuation">}</span>
</span></code></pre>
<p><img src="/posts/mid_05/231021-001859.png" alt="231021-001859"/></p></div><div class="w-72 hidden h-fit max-h-[calc(100vh-10rem)] lg:flex flex-col overflow-x-hidden overflow-y-scroll scrollbar-hide rounded-xl transition-all sticky top-32 bg-gradient-to-br from-blue-400 to-blue-950"><div class=""><p id="toc-header" class="py-3 font-extrabold leading-6 bg-black bg-opacity-20 text-white">🫧 한 눈에 보기</p><ul id="toc-content" class="px-4 pb-2 mt-2 flex flex-col items-start justify-start text-sm text-start"><li><a href="#jaccard-similarity" class="group block py-1  text-white hover:text-blue-200 hover:drop-shadow-base-bold">Jaccard Similarity</a></li><li><a href="#shingling" class="group block py-1  text-white hover:text-blue-200 hover:drop-shadow-base-bold">Shingling</a></li><li class="ml-4"><a href="#tokens" class="group flex items-start py-[2px] text-white hover:text-blue-200 hover:drop-shadow-base"><svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible text-white"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>Tokens</a></li><li><a href="#minhashing" class="group block py-1  text-white hover:text-blue-200 hover:drop-shadow-base-bold">Minhashing</a></li><li class="ml-4"><a href="#permute-the-rows" class="group flex items-start py-[2px] text-white hover:text-blue-200 hover:drop-shadow-base"><svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible text-white"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>Permute the rows</a></li><li class="ml-4"><a href="#create-signature" class="group flex items-start py-[2px] text-white hover:text-blue-200 hover:drop-shadow-base"><svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible text-white"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>Create signature</a></li><li class="ml-4"><a href="#implement" class="group flex items-start py-[2px] text-white hover:text-blue-200 hover:drop-shadow-base"><svg width="3" height="24" viewBox="0 -9 3 24" class="mr-2 overflow-visible text-white"><path d="M0 0L3 3L0 6" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg>implement</a></li></ul></div></div></section><footer class="w-full flex flex-col mt-10"><span class="text-blue-400 italic text-start">2023-10-20 / 22:12<!-- --> 에 작성을 시작했어요.</span><div class="w-full flex items-start mt-5 mb-10 space-x-5"><span>Tag</span><ul class="w-full flex list-none m-0 flex-wrap gap-1"><li class="bg-gradient-to-br from-blue-500 to-blue-400 px-3 text-white rounded-md shadow-md whitespace-nowrap"># <!-- -->Shingling</li><li class="bg-gradient-to-br from-blue-500 to-blue-400 px-3 text-white rounded-md shadow-md whitespace-nowrap"># <!-- -->Minhashing</li><li class="bg-gradient-to-br from-blue-500 to-blue-400 px-3 text-white rounded-md shadow-md whitespace-nowrap"># <!-- -->Jaccard Similarity</li></ul></div><div class="flex flex-col items-center mb-5"><div class="w-full bg-gradient-to-br from-blue-400 to-blue-950 mt-5 rounded-md overflow-hidden"><h3 class="bg-black bg-opacity-50 px-1 py-3"><span class="bg-gradient-to-br from-blue-600 to-blue-400 bg-clip-text text-transparent font-bold drop-shadow">대학 - 빅데이터 처리 및 응용</span><span class="text-white">의 다른 글</span></h3><ol class="w-full p-1 space-y-1"><li class="w-full "><a class="w-full flex justify-center text-white " href="/blog/univ_mmds/final_05">PageRank</a></li><li class="w-full "><a class="w-full flex justify-center text-white " href="/blog/univ_mmds/final_04">Recommender System</a></li><li class="w-full "><a class="w-full flex justify-center text-white " href="/blog/univ_mmds/final_03">Dimensionality Reduction &amp; SVD</a></li><li class="w-full "><a class="w-full flex justify-center text-white " href="/blog/univ_mmds/final_02">Clustering</a></li><li class="w-full "><a class="w-full flex justify-center text-white " href="/blog/univ_mmds/final_01">LSH</a></li><li class="w-full bg-black bg-opacity-20 rounded-md"><a class="w-full flex justify-center text-white before:content-[&#x27;🫧&#x27;] before:mr-2 after:content-[&#x27;🫧&#x27;] after:ml-2" href="/blog/univ_mmds/mid_05">Finding Similar Items</a></li><li class="w-full "><a class="w-full flex justify-center text-white " href="/blog/univ_mmds/mid_04">Association Rules</a></li><li class="w-full "><a class="w-full flex justify-center text-white " href="/blog/univ_mmds/mid_03">Frequent Itemset</a></li><li class="w-full "><a class="w-full flex justify-center text-white " href="/blog/univ_mmds/mid_02">Spark 개념</a></li><li class="w-full "><a class="w-full flex justify-center text-white " href="/blog/univ_mmds/mid_01">분산 파일관리 시스템</a></li></ol></div></div><section class="w-full self-center"></section></footer></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Finding Similar Items","description":"유사도 높은 문서를 찾아내는 방법을 알아봅니다.","icon":"","image":"","tags":["Shingling","Minhashing","Jaccard Similarity"],"draft":false,"date":"2023-10-20 / 22:12","content":"\n생김새가 비슷한 사이트를 묶거나, 표절 검사를 하거나, 비슷한 내용의 뉴스를 클러스터링 하는 등 여러 분야에서 사용될 수 있는 기술에 대해 설명합니다.\n\n\u003cnotice\u003e\n  생김새가 비슷한 문서를 찾아내는 기술이지, 비슷한 토픽을 찾아내는 기술은 아닙니다.\n\u003c/notice\u003e\n\n아래의 단계를 거쳐 비슷한 문서를 찾게 되는데, 각 단계에 대한 세부적인 내용은 추후에 설명합니다.\n\n1. `Shingling`을 통해 데이터(문서)를 집합으로 변환\n2. `Minhashing`을 통해 큰 집합을 작은 시그니처로 변환\n3. `LSH`를 통해 시그니처를 분류 후 비슷한 집합 찾기\n\n## Jaccard Similarity\n\n세부내용 설명 전 개념 하나만 짚고 넘어가자.\n유사도를 검사할 때, 다음과 같은 경우를 고려해보자.\n\nA, B 모두 메이져한 게임들을 주로 플레이하고, A는 RPG를, B는 FPS를 주로 플레이한다고 가정하자.\n이 때, 마이너한 장르의 게임을 예시로 들며 유사도를 검사하는데, A, B 모두 해당 게임을 보유하지 않는다고 두 사람의 유사도가 높다고 이야기 할 수 있을까?\n두 사람은 그런 마이너한 장르의 게임에 관심이 없어서 갖고있지 않을 뿐인데, 둘 다 갖고있지 않다고 두 사람의 플레이스타일이 유사하다고 판단하는 것은 무리가 있다.\n\n따라서 이런 유사도 파악의 오류를 해결하기 위해 Jaccard 유사도를 사용하여 유사도를 측정하게 된다.\n\n$$\nSim(C_1, C_2) = \\frac{|C_1 \\cap C_2|}{|C_1 \\cup C_2|}\n$$\n\n즉, **두 사람 중 한 사람이라도 해당 게임을 보유하고 있는 경우에만 두 사람이 동시에 해당 게임을 보유하는가**로 유사도를 검사하는 것이다.\n\n---\n\n## Shingling\n\n문서의 유사도를 측정할 때 그 기준이 되는 토큰을 생성하는 방법입니다.\n`k-shingle` 과 같은 용어를 사용하는데, 이는 k개의 문자로 이루어진 shingle을 의미합니다.\n실제로 비슷한 문서를 싱글링 했을 때 집합의 원소도 일치하는 부분이 매우 많습니다.\n\n예로 들어 \\\"The dog which chased the cat\\\" 이라는 문장이 있다고 했을 때, 여기서 2-shingle를 구하면 다음과 같습니다.\n\n\u003e th(보통 소문자로 변환), he, e_, _d, do, og, ...\n\n하지만, 2-shingle로 하면 th, he, do와 같이 문장으로 볼 때는 상당히 유니크한 의미를 갖는 문장이 이렇게 아무데서나 나올법한 shingle이 되어버립니다.\n따라서 보통은 `8~10`-shingle로 하는 것이 적당합니다.\n\n### Tokens\n\n10-shingle을 사용하는 경우에는 최대 $27^{10} \\approx 200조$ 개의 싱글이 생성되게 됩니다.\n이를 메모리상에서 관리하는 것은 현실적으로 불가능한 일입니다.\n\n따라서 싱글을 해싱하여 4bytes의 자료형으로 변환하여 `Token`으로서 사용하게 됩니다.\n4bytes로 최대 약 42억개의 서로 다른 싱글을 표현할 수 있습니다.\n물론 다른 싱글에 대해 같은 토큰이 생성될 수 있지만, 그리 빈번한 경우는 아닐 것이며, 효율상 이 방법이 더 좋습니다.\n\n즉, 같은 토큰을 보유한 문서가 있다면, 그 문서들은 같은 싱글을 갖고있다는 얘기이므로, 유사도가 있다고 판단할 수 있겠습니다.\n\n---\n\n## Minhashing\n\nMinhashing을 알아보기 전, 데이터를 표현하는 행렬을 읽는 법을 알고가자.\n\n| (token) | $C_1$ | $C_2$ |\n|---|---|---|\n| a | 0 | 0 |\n| b | 1 | 0 |\n| c | 0 | 1 |\n| d | 1 | 1 |\n\na 토큰(싱글)은 문서(Column) 1, 2에서 모두 없다는 뜻이고, b는 문서 1에서만 갖고있다는 뜻으로 해석하면 된다.\n참고로 위의 경우 두 문서의 Jaccard 유사도는 **1/3**이다. (a는 둘 다 없기에 비교대상이 아니다)\n\n### Permute the rows\n\n우선 행을 핸덤으로 뒤죽박죽 섞는다.\n섞는다는 것은 실제로 맊 섞는다는 것이 아닌, 탐색 순서를 섞는다는 것을 의미하는데, 구현 관점에서 해싱을 돌리는 것과 같다.\n예시를 보며 이해해보자.\n\n| (row) | $C_1$ | $C_2$ | $C_3$ |\n|---|---|---|---|\n| 1 | 0 | 1 | 1 |\n| 2 | 1 | 0 | 1 |\n| 3 | 0 | 1 | 0 |\n| 4 | 0 | 0 | 0 |\n| 5 | 1 | 0 | 1 |\n\n$h_1(x) = x \\% 5$ 해시함수를 적용하면 탐색 순서는 다음과 같아진다.\n\n\u003e **5**(0) \u0026rarr; **1**(1) \u0026rarr; **2**(2) \u0026rarr; **3**(3) \u0026rarr; **4**(4)\n\n$h_2(x) = (2x+1) \\% 5$ 해시함수를 적용하면 탐색 순서는 다음과 같아진다.\n\n\u003e **2**(0) \u0026rarr; **5**(1) \u0026rarr; **3**(2) \u0026rarr; **1**(3) \u0026rarr; **4**(4)\n\n### Create signature\n\n탐색 순서에 맞게 처음으로 1(토큰 보유)을 만나는 탐색 순서를 기록한다.\n\n\u003e $h_1$를 적용한 탐색시 생성되는 Singature matrix\n\u003e [1, 2, 1]\n\u003e\n\u003e $h_2$를 적용한 탐색시 생성되는 Singature matrix\n\u003e [1, 3, 1]\n\n즉, $C_1$에 대한 시그니처는 11, $C_2$는 23, $C_3$은 11이 된다.\n\n여기서 중요한 특징이 있는데, 시그니처의 길이가 길어질 수록(무작위 순서에 의한 탐색 횟수가 늘어날 수록) 시그니처가 일치할 확률이 Jaccard 유사도와 확률이 같아진다.\n그 이유를 간단한 예시로 이해해보자.\n\n우선, $C_2$과 $C_3$의 Jaccard 유사도는 **1/4**이다.\n그런데 이 때, Singature가 같아지는 경우는 무엇일까? 바로 **최초로 1이 나오는 시점이 같다**는 이야기이다.\n즉, 같은 row에 대해 둘 다 1이 들어가 있는 row를 고를 확률과 같아진다.\n둘 다 0인 경우를 제외하면 4개 중에 둘 다 1인 row는 1개 존재하기에 Jaccard 유사도와 동일한 **1/4** 확률을 갖는다.\n\n![231020-235719](/posts/mid_05/231020-235719.png)\n\n이해를 돕기 위해 다른 예시도 보자.\n\n원래대로라면 생성되는 모든 토큰(42억개)에 대해 유사도를 검사 했어야 했다.\n하지만, 시그니처를 만드는 과정에서 무작위 순서로 탐색을 진핼할 때, 탐색개수를 제한을 걸면 검사 시간을 줄일 수 있다.\n예로 들어 해시함수의 결과를 50까지만 검색한다면 42억개의 항목에 대해 검사를 진행하지 않아도 된다. \n\n이 때 검사 개수를 줄인 만큼 서로다른 해시를 여러 번 진행하면 신뢰도 역시 어느정도 확보할 수 있다.\n예로 들어 서로 다른 해시함수 100개를 적용한다면, 시그니처의 길이가 100으로 결정되는데, 이 길이는 충분히 신뢰도를 확보할 수 있을 것이다.\n즉, 42억개에서 100개로 압축되는 효과가 발생하는 것이다.\n\n위의 사진을 예시로 실제 Jaccard 유사도와 시그니처 유사도를 비교해보며 시그니처 길이가 신뢰도에 어느정도 영향을 주는지 알아보자.\n\n\u003e Column 1, 2\n\u003e Jaccard Similarity: **1/4**\n\u003e Singature Similarity: **1/3**\n\u003e\n\u003e Column 2, 3\n\u003e Jaccard Similarity: **1/5**\n\u003e Singature Similarity: **1/3**\n\u003e\n\u003e Column 3, 4\n\u003e Jaccard Similarity: **1/5**\n\u003e Singature Similarity: **0**\n\n### implement\n\n의사코드로 구현해보고 시그니처 생성과정을 살펴보자.\n\n```cpp:의사코드\n// 처음에 무한대로 초기화\nfor (all i and c) M(i, c) = inf;\n\n// 각 행에 대해 반복하는데, 여기에 탐색개수 50개와 같은 제한을 걸 수 있음\nfor (each row r) {\n  for (each hash function h_i) {\n    compute h_i(r);\n  }\n  for (each column c) {\n    // 탐색지점에 1이 있는 경우\n    if (c has 1 in row r) {\n      for (each hash function h_1) {\n        // 저장된 시그니처보다 새 탐색값이 작은 경우에만 업데이트\n        if (h_i(r) is smaller them M(i, c)) {\n          M(i, c) = h_i(r);\n        }\n      }\n    }\n  }\n}\n```\n\n![231021-001859](/posts/mid_05/231021-001859.png)","slug":"univ_mmds/mid_05","readingMinutes":11,"wordCount":927},"posts":[{"title":"PageRank","description":"인터넷 페이지의 중요도 순위를 매기는 방법을 알아봅니다.","icon":"","image":"","tags":["PageRank","Surfer model","Google formulation"],"draft":false,"date":"2023-12-06 / 22:54","content":"\n검색 엔진을 개발할 때, 인터넷의 웹 페이지들을 사용자에게 제공함에 있어, 중요한 페이지를 우선적으로 노출시켜 주는 것이 중요합니다.\n이 때, 어떤 페이지가 중요한지를 어떻게 알 수 있을까요?\n\n## PageRank\n\nPageRank가 높으면 중요한 페이지로 인식을 하게 됩니다.\n이제, 페이지에 PageRank를 매기는 방법을 알아봅시다.\n\n![231206-230644](/posts/final_05/231206-230644.png)\n\n우선 인터넷은 방향 그래프의 형태로 표현 가능합니다.\n여기서 중요한 페이지는 무엇일까요?\n\n중요한 페이지는 아래와 같은 특징이 있습니다.\n\n- 중요한(믿을만한) 정보는 중요한 정보를 **서로** 가리키는 경향이 있음\n- 특정 query에 대한 링크를 많이 갖고 있는 페이지는 해당 query의 중요한 응답 페이지임\n\n이를 in-link로 정리하면 다음과 같아집니다.\n\n- 중요한 페이지는 in-link가 많음\n- 같은 in-link 개수라도, 중요한 페이지로부터 오는 in-link가 많을수록 중요한 페이지임\n\n\u003ctip\u003e\n  `in-link / out-link`\n  \u003cbr /\u003e\n  ![231206-231125](/posts/final_05/231206-231125.png)\n\u003c/tip\u003e\n\n### Surfer model\n\n그렇다면 in-link의 개수와 세기를 이용해서 페이지의 중요도를 파악해야 하는데, 어떤 방식으로 파악하는 것이 좋을까요?\n그에 대한 하나의 해답으로 surfer model이 있습니다.\n\n동작 방식은 다음과 같습니다.\n\n1. 랜덤한 페이지들에 surfer를 배치\n2. 한 스탭마다 페이지의 out-link로 surfer 들을 이동\n3. 2번 반복\n4. surfer들이 페이지들에 특정한 분포로 수렴하도록 이동함\n\n여기서 중요한 점은 초기에 surfer를 어떻게 배치하더라도 결국은 특정한 분포로 페이지들에 분포하게 된다는 것입니다.\n(마치 자연계의 생물 개체수가 일정 비율로 유지되듯...)\n\n그렇다면 2번에서 surfer를 어떻게 이동시키는 걸까요?\n위의 예시를 이용해서 알아봅시다.\n\n![231206-230644](/posts/final_05/231206-230644.png)\n\n$r_i$를 페이지 i의 rank라고 하고 페이지 y, a, m의 rank를 계산하면 아래와 같습니다.\n\n$$\nr_y = r_y/2 + r_a/2 \\\\\nr_a = r_y/2 + r_m \\\\\nr_m = r_a/2\n$$\n\n**각 페이지로 in-link되는 페이지의 1/out-degree 의 합**으로서 표현되며, 수식화하면 아래와 같습니다.\n\n$$\nr_j = \\sum_{i \\to j} \\frac{r_i}{d_i}\n$$\n\n그렇다면 PageRank는 위에서 나온 3개의 식을 연립하여 계산하면 됩니다... 만,\n해가 무수히 많이 나오는 문제가 있습니다.\n따라서 $\\sum{r_i} = 1$ 이라는 제약 조건을 달아서 계산하면 됩니다. (1말고 다른것도 가능하지만, 1이 쉬워서..)\n\n하지만, 이 경우 시간복잡도가 $O(n^3)$이 나오기 때문에 현실세계에선 사용하기 어렵습니다.\n따라서 행렬로 계산하는 것이 좋습니다.\n\n$$\n1 \\begin{bmatrix}\nr_y \\\\\nr_a \\\\\nr_m\n\\end{bmatrix} = \\begin{bmatrix}\n\\frac{1}{2} \u0026 \\frac{1}{2} \u0026 0\\\\\n\\frac{1}{2} \u0026 0 \u0026 1 \\\\\n0 \u0026 \\frac{1}{2} \u0026 0\n\\end{bmatrix} \\begin{bmatrix}\nr_y \\\\\nr_a \\\\\nr_m\n\\end{bmatrix}\n$$\n\n$$\nr = M \\cdot r\n$$\n\n여기서 1은 $\\sum{r_i} = 1$ 에서 나온 제약 조건입니다.\n\n즉, 이렇게 하면 앞에서 글로만 적었던 Surfer model의 동작방식을 알고리즘화 할 수 있습니다.\n\n1. Set r = \\[1/N, 1/N, 1/N\\]\n2. r' = Mr\n3. r = r'\n4. Goto 2\n\n참고삼아 방향성이 없은 graph 모델의 경우 PageRank는 아래와 같은 수식으로 구할 수 있습니다.\n\n$$\nr_v = \\frac{d_v}{2m}\n$$\n\n여기서 $d_v$는 **노드 v에 연결된 edge의 수**를 의미하고, m은 **전체 edge의 수**를 의미합니다.\n\n\u003cnotice\u003e\n  Degree(in-link)가 높다고 PageRank가 항상 더 높은 것은 아닙니다.\n  \u003cbr /\u003e\n  ![231206-233606](/posts/final_05/231206-233606.png)\n  \u003cbr /\u003e\n  위 경우에는 3의 PageRank가 더 높을거 같지만, 1이 더 높게 측정됩니다.\n\u003c/notice\u003e\n\n### Google formulation\n\n기존 surfer model에는 치명적인 문제가 있습니다.\n바로 Dead-end, Spider-trap 문제입니다.\n\n![231206-233818](/posts/final_05/231206-233818.png)\n\n이 경우 페이지 m이 spider-trap입니다.\n다른 페이지로의 out-link가 없고 특정 circle에 같히기 떄문이죠.\n이련 경우에는 PageRank 계산시 $r_m = 1$ 이 되어버리고, 나머지는 0이되는 문제가 발생합니다.\n\n![231206-233954](/posts/final_05/231206-233954.png)\n\n이 경우 페이지 m이 dead-end입니다.\nout-link가 아예 존재하지 않아 surfer가 이동하지 못하고 소멸하기 때문이죠.\n이런 경우에는 PageRank 계산시 모두 0이되는 문제가 발생합니다.\n\n이런 현실세계의 문제를 해결하기 위해 Google에서 개선한 알고리즘이 바로 이것입니다.\n\n- spider-trap을 예방하기 위해 일정 확률(대충 0.1~0.2)로 링크로 연결된 페이지가 아닌 아예 생뚱맞은 페이지로 surfer를 점프\n- dead-end의 경우(out-link가 없는 경우) surfer를 생뚱맞은 페이지로 점프\n\n이를 반영한 PageRank 수식은 다음과 같습니다.\n\n$$\nr_j = \\sum_{i \\to j} \\beta \\frac{r_i}{d_i} + (1-\\beta)\\frac{1}{N}\n$$\n\n앞에 $\\frac{r_i}{d_i}$ 부분은 위와 동일합니다.\n다만, $\\beta$의 확률로만 적용됩니다. (대략 0.8~0.9)\n\n나머지 0.1~0.2의 확률로는 N개의 페이지 중 하나로 이동하는 방식을 적용한 것입니다!\n\n그럼 여기서 의문점이 듭니다.\n\n\u003e spider-trap은 해결한거 같은데 dead-end는요?\n\nspider-trap인지 아닌지는 판단할 수 있는 방법이 없기 때문에 위와 같이 확률에 의존하여 해결하였지만,\ndead-end인지 아닌지는 판단할 수 있는 방법이 존재합니다. (단순히 out-link의 개수가 0이면 dead-end)\n따라서 dead-end의 경우에는 그냥 surfer를 다른곳으로 점프시키면 됩니다.\n\n위 식을 행렬식으로 변환해볼까요?\n\n$$\n\\begin{bmatrix}\nr_y \\\\\nr_a \\\\\nr_m\n\\end{bmatrix} = (0.8 \\begin{bmatrix}\n\\frac{1}{2} \u0026 \\frac{1}{2} \u0026 0\\\\\n\\frac{1}{2} \u0026 0 \u0026 1 \\\\\n0 \u0026 \\frac{1}{2} \u0026 0\n\\end{bmatrix} + 0.2 \\begin{bmatrix}\n\\frac{1}{3} \u0026 \\frac{1}{3} \u0026 \\frac{1}{3} \\\\\n\\frac{1}{3} \u0026 \\frac{1}{3} \u0026 \\frac{1}{3} \\\\\n\\frac{1}{3} \u0026 \\frac{1}{3} \u0026 \\frac{1}{3}\n\\end{bmatrix})\\begin{bmatrix}\nr_y \\\\\nr_a \\\\\nr_m\n\\end{bmatrix}\n$$","slug":"univ_mmds/final_05","readingMinutes":8,"wordCount":669},{"title":"Recommender System","description":"추천 시스템의 종류와 동작 방식에 대해 알아봅니다.","icon":"","image":"","tags":["Recommender System","Content-based","TF-IDF","Collaborative Filtering"],"draft":false,"date":"2023-12-04 / 15:23","content":"\n사람이 손수 작성한 추천목록, 플레이리스트 등 기존의 추천엔 한계가 있습니다.\n따라서 개인화된 추천 시스템을 만들어야 하는데, 이를 개발할 때 여러 문제점들이 있습니다.\n\n- 훈련 데이터를 얻기 힘듦\n- 입력 안된 데이터를 채우기 힘듦 (평가 안된 항목 예측이 힘듦)\n- 추천 방식의 성능을 평가할 방식을 찾기 힘듦\n\n그렇기에 이러한 요소를 염두해두고 아래의 소개되는 추천 시스템을 비교하며 알아보도록 합시다.\n\n## Content-based\n\n기본적인 아이디어는 추천 대상을 여러가지 키워드의 벡터로 표현하고, 유저의 추천 대상에 대한 평점을 기반으로 벡터의 값을 계산해 비슷한 아이템을 추천하는 것입니다.\n\n따라서, 우선 영화라고 한다면 감독, 배우, 장르 등등의 키워드로서 영화를 표현해야 하는데요, 특징을 추출하는데는 TF-IDF 휴리스틱 알고리즘이 사용됩니다.\n\n### TF-IDF\n\nIF-IDF score는 아래와 같은 수식으로 계산합니다.\n\n$w_{ij} = TF_{ij} \\times IDF_i$\n_j: 문서, i: 단어_\n\n여기서 TF는 i-단어가 j-문서에 얼마나 많이 등장하는지에 대한 척도로, 아래와 같이 계산됩니다.\n\n$$\nTF_{ij} = \\frac{f_{ij}}{max_k f_{kj}}\n$$\n\n**i-단어의 등장횟수**를 **한 문서에 대해 가장 많이 등장하는 단어의 등장횟수**로 나눠줌으로서 문서의 길이에 비해 많이 나오는 정도(normalize)를 캐치합니다.\n\n하지만, 모든 문서에 대해 빈번하게 등장하는 단어의 경우에는 키워드로서 부적절 할 것입니다.\n따라서 이런 단어들에 대한 페널티를 부과하기 위해 IDF 항이 존재하며, 식은 아래와 같습니다.\n\n$$\nIDF_i = log \\frac{N}{n_i}\n$$\n\n**전체 문서의 개수**를 **i-단어가 나온 문서의 수**로 나눠줍니다.\n즉, 단어가 특이하게 많이 등장할수록 큰 점수를 부여하는 방식입니다.\n\n### User Profiles\n\nTF-IDF를 이용해서 item을 프로파일링 했으니, 이제 user를 프로파일링 해보겠습니다.\n\n예로 들어 아래와 같이 프로파일링된 item들이 있다고 가정해보겠습니다.\nTF-IDF에서 선택된 키워드는 1, 아닌 키워드는 0으로 표기됩니다.\n\n|  | keywordA | keywordB | keywordC | keywordD | keywordE |\n|---|---|---|---|---|---|\n| itemA | 1 | 1 | 0 | 0 | 0 |\n| itemB | 1 | 0 | 1 | 0 | 0 |\n| itemC | 0 | 0 | 0 | 1 | 1 |\n\n그리고 user들이 이런 item에 평점을 매겼다고 가정해보겠습니다.\n\n|  | itemA | itemB | itemC | average |\n|---|---|---|---|---|\n| user1 | 5(1) | 3(-1) | 0 | 4 |\n| user2 | 3(0) | 1(-2) | 2(-1) | 3 |\n| user3 | 3(0) | 0 | 3(0) | 3 |\n| rate(diff) ||||\n\nuser 프로파일링은 item profile에 대한 평점을 이용한 가중평균을 사용합니다.\n\n| user1 | keywordA | keywordB | keywordC | keywordD | keywordE |\n|---|---|---|---|---|---|\n| itemA | 5 | 5 | 0 | 0 | 0 |\n| itemB | 4 | 0 | 4 | 0 | 0 |\n| itemC | 0 | 0 | 0 | 0 | 0 |\n| average | 3 | 5/3 | 4/3 | 0 | 0 |\n\n하지만, 이렇게되면 유저가 평가하지 않은 항목에 대해서는 반드시 부정적인 평가가 이루어지게 되는 문제가 있습니다.\n따라서, **유저의 평점에서 평점의 평균 뺀 값 (diff)** 을 사용해서 가중평균을 구하는 것이 좋습니다.\n\n| user1 | keywordA | keywordB | keywordC | keywordD | keywordE |\n|---|---|---|---|---|---|\n| itemA | 1 | 1 | 0 | 0 | 0 |\n| itemB | -1 | 0 | -1 | 0 | 0 |\n| itemC | 0 | 0 | 0 | 0 | 0 |\n| average | 0 | 1/3 | -1/3 | 0 | 0 |\n\n같은 방식으로 user를 모두 프로파일링 하면 다음과 같은 profile을 얻을 수 있습니다.\n\n|  | keywordA | keywordB | keywordC | keywordD | keywordE |\n|---|---|---|---|---|---|\n| user1 | 0 | 1/3 | -1/3 | 0 | 0 |\n| user2 | -2/3 | 0 | -2/3 | -1/3 | -1/3 |\n| user3 | 0 | 0 | 0 | 0 | 0 |\n\n\u003ctip\u003e\n  user profile를 이용해서 비슷한 사용자를 찾을 때는 cosine 유사도, L1-norm 유사도의 방법을 사용하곤 합니다.\n  cosine 유사도(방향)는 취향 유사도를 판단할 때 쓰이고, L1-norm(차원별 거리)는 구매력 유사도를 판단할 때 사용하면 좋습니다.\n\u003c/tip\u003e\n\n\u003ctip\u003e\n  user profile를 이용해서 비슷한 item을 찾을 때는 [`LSH`](https://wjlee611.github.io/blog/univ_mmds/final_01)를 사용하면 됩니다.\n\u003c/tip\u003e\n\n### Pros \u0026 Cons\n\n장점\n- 다른 유저가 없어도 item을 추천할 수 있다(cold start 문제가 없다)\n  (물론, user profiling은 cold start 문제가 있다)\n- 독특한 취향의 사람에게도 추천할 수 있다\n- 새로운 item이나, 독특한 item의 경우에도 잘 동작한다\n- 추천에 대한 설명도 제공할 수 있다\n\n단점\n- 분야에 따라 추출해야 하는 keyword를 찾아야 한다\n- 새로운 user에 대한 추천은 어렵다\n- 너무 사용자 전용 추천이 되어버린다\n  (관심 밖은 추천이 아예 안되고, 다른 사람의 취향(트렌드)를 따르지 않음)\n\n---\n\n## Collaborative Filtering\n\n위에서는 item을 프로파일링 했다면, Collaborative Filtering 방식은 그런 프로파일을 작성하지 않습니다.\n이 방식은 단순히 utility matrix(위에 user의 item에 대한 평점 matrix)를 사용합니다.\n\n### User-User C.F.\n\n나와 비슷한 유저를 추천해주는 시스템을 만들기 위해 User-User Collaborative Filtering을 사용합니다.\n빠르게 LSH로 찾을 수도 있겠지만, 정밀한 추천을 위해 예시와 함께 다른 추천방법을 알아봅시다.\n\n우선, 유저 A~D의 item에 대한 평점정보가 아래와 같이 있다고 가정해봅시다.\n\n|  | item1 | item2 | item3 | item4 | item5 | item6 | item7 | avg |\n|---|---|---|---|---|---|---|---|---|\n| A | 4 |  |  | 5 | 1 |  |  | 10/3 |\n| B | 5 | 5 | 4 |  |  |  |  | 14/3 |\n| C |  |  |  | 2 | 4 | 5 |  | 11/3 |\n| D |  | 3 |  |  |  |  | 3 | 3 |\n\n만약 Jaccard 유사도를 기준으로 측정한다면 어떻게 될까요?\nA-B 유사도는 1/5, A-C 유사도는 1/2가 나올 것입니다.\nJaccard 유사도는 영화의 평점을 반영하지 못하기 때문에 여기서 사용하는 것은 부적절해 보입니다.\n\n이번엔 Cosine 유사도를 기준으로 측정해봅시다.\nA-B 유사도는 0.380, A-C 유사도는 0.322가 나올 것입니다.\nB가 C보다 A와 비슷하다는 점은 잘 캐치하는 것을 볼 수 있습니다.\n하지만, C가 A와 비슷한게 아니라 취향이 다르다는 점은 캐치하지 못합니다.\n\nNegative도 캐치할 수 있도록 피어슨 상관계수를 기준으로 측정해봅시다.\n\u003ctip\u003e\n  피어슨 상관계수는 평점을 평점의 평균으로 뺀 값을을 코사인 유사도를 측정한 것입니다.\n  피어슨 상관계수를 사용하면 좋은게, 부정적인 정도도 나타낼 수 있을 뿐만 아니라,\n  사용자가 평가하지 않은 항목은 0으로 출력한다는 점에서 좋습니다.\n\u003c/tip\u003e\nA-B 유사도는 0.092, A-C 유사도는 -0.559가 나올 것입니다.\n이제는 얼마나 다른지도 \\[-1, 1\\] 범위로 잘 측정할 수 있습니다.\n\n이렇게 나온 필터를 이용해서 유저에게 영화를 추천할 수 있습니다.\n위에서 나온 가중평균을 이용하면 되는데요, 여기서는 소개하지 않겠습니다.\n왜냐하면, Item-Item 필터로 추천하는 것이 성능이 더 좋기 때문입니다.\n(user의 취향은 여러개가 동시에 존재할 수 있지만, item은 일정하고 간단하기 때문)\n\n### Item-Item C.F.\n\n이제 Item-Item Collaborative Filtering 을 이용해서 item의 평점을 예측하고, 그 평점을 바탕으로 user에게 추천을 주도록 해봅시다.\n\n위의 예시를 그대로 사용하겠습니다.\n여기서 item2을 userA에게 추천할만한지 판단하기 위해 userA의 item2에 대한 평점을 예측해보겠습니다. \n\n|  | item1 | item2 | item3 | item4 | item5 | item6 | item7 |\n|---|---|---|---|---|---|---|---|\n| A | 4(2/3) | **\\[!\\]** |  | 5(5/3) | 1(-7/3) |  |  |\n| B | 5(1/3) | 5(1/3) | 4(-2/3) |  |  |  |  |\n| C |  |  |  | 2(-5/3) | 4(1/3) | 5(4/3) |  |\n| D |  | 3(0) |  |  |  |  | 3(0) |\n| $Sim_{item2}$ | 0.45 | 1.00 | -1.00 | 0 | 0 | 0 | 0 |\n\n여기서 $Sim_{item2}$는 item2에 대한 각 item의 피어슨 상관계수를 구한 것입니다.\n이제 item2의 가중평균을 아래와 같은 계산식으로 구해줍니다.\n\n$$\n\\frac{0.45*4 + 0*5 + 0*1}{0.45 + 0 + 0} = 4\n$$\n\n즉, item2에 대한 userA의 평점을 4로 예측하였고, 이는 userA 평균평점 이상이기에 추천할만한 item이라 판단할 수 있겠습니다.\n\n\u003cnotice\u003e\n  지금은 가중 평균 계산시 모든 item을 다 사용했지만,\n  일반적으로는 Sim(유사도)이 높은 k개의 item만을 가지고 평점을 예측합니다.\n\u003c/notice\u003e\n\n**장단점**은 Content-based와 정 반대입니다.\n\n추가로, 유사한 k개를 찾을 때, 그 k를 구하는 것이 어렵다는 단점도 있습니다.\n그럴때는 그냥 LSH, 클러스터링, 차원축소 등을 사용하는 것도 하나의 방법입니다.\n추천 알고리즘의 정답은 없으니까요!\n\n\u003ctip\u003e\n  추천 시스템을 개발할 때는 일반적으로 복잡한 알고리즘을 쓰는 것 보다,\n  단순한 알고리즘을 쓰되, 데이터를 많이 집어넣는게 좋습니다.\n\u003c/tip\u003e\n\n---\n\n## Evaluating Prediction\n\n마지막으로 추천 시스템을 평가하는 방법을 알아봅시다.\n대표적으로 아래의 평가 방법이 있습니다.\n\n- RMSE\n  오차의 제곱근(큰 오차에 대한 페널티 부여)의 평균을 이용합니다.\n  $\\sqrt{\\frac{1}{N} \\sum_{xi}(r_{xi}-r_{xi}^*)^2}$\n- MAE\n  오차의 절댓값의 평균을 이용합니다.\n  $\\frac{1}{N} \\sum_{xi}|r_{xi}-r_{xi}^*|$\n\n예시로 알아봅시다.\n\n| | | MAE | RMSE |\n|---|---|---|---|\n| 실제 평점 | 2 2 2 | - | - | \n| 예측 A | 3 3 3 | 1 | 1 |\n| 예측 B | 2 2 5 | 1 | $\\sqrt{3}$ |\n\n물론 이 측정 방법의 한계도 존재합니다.\n바로, 아래의 상황을 반영하지 못하는 것이죠..\n\n- 추천 다양성\n  e.g. 어떤 영화를 많이 봤는데, 이와 다른 장르는 추천하지 않는 현상\n- 추천 문맥\n  e.g. 여행 당시에 사놓은 여행 서적의 기록을 갖고, 평상시에도 여행 서적을 추천하는 현상\n- 추천의 순서\n  e.g. 시리즈물은 순서별로 추천해야 하는데 그렇지 않은 현상","slug":"univ_mmds/final_04","readingMinutes":15,"wordCount":1350},{"title":"Dimensionality Reduction \u0026 SVD","description":"차원 축소 기법과 고윳값 분해에 대해 알아봅니다.","icon":"","image":"","tags":["Dimensionality Reduction","SVD","concept"],"draft":false,"date":"2023-12-04 / 13:15","content":"\n## Dimensionality Reduction\n\n차원 축소 방법에 대해 알아보기 전에, 왜 차원축소를 하는걸까요?\n다음과 같은 이유들이 있다고 생각합니다.\n\n- [**차원의 저주**](https://wjlee611.github.io/blog/univ_mmds/final_02#curse-of-dimensionality) 해결\n- 데이터 용량 절약\n- 잠재된 관점(축)의 발견\n\n그렇다면 차원 축소는 어떤 원리를 이용해서 하게 되는 걸까요?\n아래의 예시를 봐봅시다.\n\n![231204-135530](/posts/final_03/231204-135530.png)\n\n좌측은 2차원 데이터인데 하나의 직선 위에 데이터들이 많이 밀집된 형태를 보입니다.\n우측은 3차원 데이터인데 하나의 평면 위에 데이터들이 많이 밀집된 형태를 보입니다.\n\n만약, 직선이나 평면에 데이터들을 적절하게 투영(projection)할 수 있다면?\n데이터를 표현하기 위해 2, 3개의 파라미터를 사용해야 했던 것에 반해, 1, 2개의 파라미터 만으로 데이터를 표현할 수 있을 것입니다.\n\n그렇지만, 무턱대고 투영하는 것은 좋지 않습니다.\n최대한 데이터의 손실이 적도록 투영하는게 옳은 방법이겠죠?\n\n데이터의 손실이 적도록 차원을 축소하기 위해서는 새로운(낮은) 차원의 축을 잘 선택해야 합니다.\n축을 잘 선택하는 방법은 아래와 같은 순서로 진행하면 왠만하면 차원 축소할 때 데이터의 손실이 적을 것입니다.\n\n1. 데이터의 분산이 가장 큰 방향의 축을 선택\n2. 1에서 선택한 축의 수직인 방향의 축을 선택\n3. 1, 2에서 선택한 축의 수직인 방향의 축을 선택... (반복)\n\n### Rank\n\n축을 선택하는 방법은 대강 알 거 같습니다.\n그러면 얼마나 축을 뽑는게 좋은걸까요?\n\n답은 행렬의 rank 에 해당하는 만큼 축을 뽑으면 됩니다.\n\n\u003ctip\u003e\n  `Rank`\n  \u003cbr /\u003e\n  rank는 선형 독립적인 행의 개수를 의미합니다.\n\u003c/tip\u003e\n\n예시와 함께 알아봅시다.\n\n$$\nA = \\begin{bmatrix}\n1 \u0026 2 \u0026 1 \\\\\n-2 \u0026 -3 \u0026 1 \\\\\n3 \u0026 5 \u0026 0 \\\\\n\\end{bmatrix}\n$$\n\nrank(A) = 2 입니다.\n왜냐하면 3행은 **1행 - 2행** 으로 표현되기 때문에 3행은 선형 종속적인 행이기 때문입니다.\n\n즉, 기존 basis \\[1 0 0\\], \\[0 1 0\\], \\[0 0 1\\] 의 3축에서 \\[1 2 1\\], \\[-2 -3 1\\] 의 2축으로 차원을 축소할 수 있습니다.\n그렇다면 A는 아래와 같이 변형되겠죠?\n\n$$\nA_{with\\_new\\_basis} = \\begin{bmatrix}\n1 \u0026 0 \\\\\n0 \u0026 1 \\\\\n1 \u0026 -1 \\\\\n\\end{bmatrix}\n$$\n\n---\n\n## SVD\n\n3차원은.. 좀만 노력하면 분해할 수 있지만, 30차원이 넘어간다면?\n아마 특정 공식에 의존하여 분해하는 것이 좋을 것입니다.\n차원을 직접적으로 축소하는 방법은 아니지만, 하나의 행렬을 의미가 담긴 3개의 행렬로 분해하는 방법이 바로 SVD, 고윳값 분해 입니다.\n\n![231204-142024](/posts/final_03/231204-142024.png)\n\n행렬 A는 $U \\sum V^T$로 데이터 손실 없이 분해됩니다.\n다만 차원을 줄이기 위해 r을 보다 작은 값으로 분해하여 약간의 데이터 손실과 함께 차원을 축소하는 것이죠.\n\n아무튼, SVD는 위의 $U \\sum V^T$ 형태의 3개의 행렬로 분해하는데, 각각 행렬마다 중요한 특징이 있습니다.\n그 특징을 아래의 예시와 함께 살펴보겠습니다.\n\n![231204-143118](/posts/final_03/231204-143118.png)\n\n우선 **$A$** 부터 살펴보겠습니다.\n예시로 든 행렬은 유저가 평가한 영화 평점에 대한 행렬입니다.\n예로 들어, 4행의 유저는 SciFi한 영화에는 5점을 남겼지만, Romance 영화는 관심도 없다는 의미겠네요.\n\n다음은 **$\\sum$** 을 살펴보겠습니다.\n$\\sum$은 대각 행렬로, 원소가 좌상단부터 우하단으로 반드시 내림차순 정렬되어 있습니다.\n그렇기 때문에 SVD시 $U \\sum V^T$가 유일하게 결정됩니다.\n\n여기서 $\\sum$은 `concept`의 세기에 대한 정보를 담고 있습니다.\n| Value | Concept |\n|---|---|\n| 12.4 | Sci-fi |\n| 9.5 | Romance |\n| 1.3 | Romance-Alien |\n\n즉 데이터들이 Sci-fi, Romance 한 concept에 대해 분산이 크지만,\nRomance-Alien 과 같은 잡스러운(?) concept에 대한 분산은 낮음을 알 수 있습니다.\n(차후에 이를 이용해 차원 축소를 하게 됩니다)\n\n다음은 **$U$** 를 살펴보겠습니다.\n이 행렬은 유저에 대한 concept 정보를 담고 있습니다. (별로 안중요함)\n\n마지막으로 **$V^T$** 를 살펴보겠습니다.\n이 행렬은 영화에 대한 concept 정보를 담고 있습니다. (별로 안중요함)\n\n### D.R. with SVD\n\n이제 고윳값 분해 방식과 의미를 알았으니 차원을 실제로 축소해봅시다.\n\n바로 위에서 다음과 같이 언급했었습니다.\n\n\u003e 즉 데이터들이 Sci-fi, Romance 한 concept에 대해 분산이 크지만,\n\u003e Romance-Alien 과 같은 잡스러운(?) concept에 대한 분산은 낮음을 알 수 있습니다.\n\n분산이 크다는 것은 해당 축으로 투영시켰을 때, 데이터 손실이 적다는 것을 의미한다고 했었습니다.\n즉, $\\sum$의 값이 작은 부분을 제거한다면?\n영향력이 적은 차원을 제거하는 꼴이 되어버려서 차원 축소를 달성할 수 있습니다!\n\n![231204-144815](/posts/final_03/231204-144815.png)\n\n이렇게 SVD로 분해된 세 행렬을 계산하면 다음과 같이 복원할 수 있습니다.\n\n![231204-144924](/posts/final_03/231204-144924.png)\n\n상당히 유사하지만, 데이터 손실 때문에 완벽하게 복원되지는 않았습니다.\n즉, 데이터의 손실이 발생할 수 있는 점을 염두하여 차원을 축소해야 합니다.\n\n그렇다면 차원축소는 얼마나 하는것이 좋을까요?\n\n정해진 답은 없지만, 일반적으로 SVD된 $\\sum$ 행렬의 에너지(대각선 제곱의 합)의 90% 이상 남기는 것이 좋다고 알려져 있습니다.\n예로 들어서 차원 축소 전의 $\\sum$ 에너지는 아래와 같습니다.\n\n$$\n12.4^2 + 9.5^2 + 1.3^2 = 245.7\n$$\n\nRomance-Alien concept를 제거한다면 에너지는 아래와 같이 감소합니다.\n\n$$\n12.4^2 + 9.5^2 = 244.01\n$$\n\n즉, Romance-Alien concept 차원을 제거하여 축소한다고 해도 원본의 99%에 해당하는 에너지가 해당되기에 차원을 축소해도 데이터 손실이 거의 없습니다.\n하지만, 여기에서 Romance concept까지 제거한다면?\n\n$$\n12.4^2 = 153.76\n$$\n\n62.6%의 에너지밖에 남지 않습니다.\n즉, 차원을 많이 줄일수는 있지만, 복원했을 때 유의미한 데이터를 얻을 수는 없을 것입니다.\n\n---\n\n## Application\n\n이제 실제 예시와 함께 분석하는 방법을 알아봅시다.\n\n![231204-144815](/posts/final_03/231204-144815.png)\n\n위와 같이 관리되고 있는 추천 시스템 데이터에서 \"Matrix\" 와 같은 SciFi concept의 영화를 좋아하는 유저를 찾고싶다고 해봅시다.\n\n![231204-150645](/posts/final_03/231204-150645.png)\n\n그럴 때는 유저 벡터를 concept-space에 투영해서 그 방향(경향)을 비교하는게 좋습니다.\n그리고 그 투영을 구하는 방법은 $q \\cdot V_{concept}$ 이죠.\n\n예로 들어 아래와 같은 유저 p, q의 영화 성향이 같은지 다른지를 판단해봅시다.\n\n$$\np = \\begin{bmatrix}\n5 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \n\\end{bmatrix}\n$$\n$$\nq = \\begin{bmatrix}\n0 \u0026 4 \u0026 5 \u0026 0 \u0026 0 \n\\end{bmatrix}\n$$\n\nJaccard 유사도, LSH와 같은 방식을 사용한다면, 두 사람은 전혀 다른 취향을 가진 사람이라고 판단할 것입니다.\n하지만, $q \\cdot V$을 이용하여 concept 벡터를 만들어 비교해본다면 어떨까요?\n\n$$\np_{concept} = \\begin{bmatrix}\n5 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \n\\end{bmatrix} \\begin{bmatrix}\n0.56 \u0026 0.12 \\\\\n0.59 \u0026 -0.02 \\\\\n0.56 \u0026 0.12 \\\\\n0.09 \u0026 -0.69 \\\\\n0.09 \u0026 -0.69\n\\end{bmatrix} = \\begin{bmatrix}\n2.8 \u0026 0.6\n\\end{bmatrix}\n$$\n$$\nq_{concept} = \\begin{bmatrix}\n0 \u0026 4 \u0026 5 \u0026 0 \u0026 0 \n\\end{bmatrix} \\begin{bmatrix}\n0.56 \u0026 0.12 \\\\\n0.59 \u0026 -0.02 \\\\\n0.56 \u0026 0.12 \\\\\n0.09 \u0026 -0.69 \\\\\n0.09 \u0026 -0.69\n\\end{bmatrix} = \\begin{bmatrix}\n5.2 \u0026 0.4\n\\end{bmatrix}\n$$\n\np, q 유저의 성향이 비슷하다고 판단되었습니다.\n심지어 SVD 이후 차원까지 축소했는데도 말이죠!\n\n이렇듯 취향을 판단하면서, 데이터를 압축해야 할 경우에는 SVD가 유리하게 작동합니다.\n또한, 차원을 낮추면서 근사하는 방식에는 SVD가 최적해를 도출한다고 증명이 되었습니다.\n\n하지만, 압축한 데이터에 대해서는 해석할 수 없으며, 원래 행렬의 대부분의 값이 0으로 채워진 경우에는 SVD를 하면 오히려 원소의 개수가 늘어난다는 단점도 있습니다.\n","slug":"univ_mmds/final_03","readingMinutes":12,"wordCount":958},{"title":"Clustering","description":"여러 군집화 방법에 대해 알아봅니다.","icon":"","image":"","tags":["Curse of Dimensionality","Hierachical Clustering","Point-assignment Clustering","K-means","L1-norm","L2-norm","Edit distance"],"draft":false,"date":"2023-12-03 / 21:28","content":"\n## Clustering\n\n군집화란 여러개의 점(데이터)들의 집합이 주어졌을 때, 거리에 따라 점들을 그룹으로 묶는 행위를 의미합니다.\n점들을 그룹으로 묶을 때는 유사도(거리)를 기준으로 cluster를 생성하게 되는데요, 사용되는 거리의 단위에는 아래와 같은 것들이 있습니다.\n\n- **Euclidean**\n  - $L_2$ norm\n    일반적인 두 점 사이의 거리 ($\\sqrt{(x_a - x_b)^2 + (y_a - y_b)^2}$)\n\n  - $L_1$ norm (Manhattan distance)\n    차원별로 두 점 사이의 거리 ($|x_a - x_b| + |y_a - y_b|$)\n\n  즉, L1, L2 norm이 같은 경우는 같은 차원 축 위에 존재하는 경우밖에 없습니다. (L1의 값이 L2보다 같거나 더 큽니다)\n\n  \u003ctip\u003e\n    L2는 차원간 거리의 차이가 클 수록 페널티를 부여하는 효과가 있습니다.\n    \u003cbr /\u003e\n    예로 들어, 점 x로 부터의 거리가 각 축별로 다음과 같다고 가정해봅시다.\n    A = 2,3,4\n    B = 1,3,5\n    \u003cbr /\u003e\n    이 때 L1는 거리가 9로 같지만, L2는 B가 더 멀다고 판단합니다.\n    (3축의 거리차가 더 크기에 더 큰 페널티 부여)\n  \u003c/tip\u003e\n\n\n- **Cosine** (for vector)\n  $cos(x,y) = \\frac{x \\cdot y}{||x|| \\cdot ||y||}$\n  방향성이 얼마나 비슷한지를 거리로 사용합니다.\n  내적 식과 동일합니다.\n\n- **Jaccard** (for sets)\n  e.g. Jaccard 유사도가 1이다 \u0026rarr; 두 원소가 완전 일치한다 \u0026rarr; 거리는 0이다\n\n- **Edit distance** (for strings)\n  문자열 x가 문자열 y로 변환되기 위한 과정의 횟수를 거리로 사용합니다.\n  여기서 LCS 라는 개념이 등장하는데, LCS는 끊겨도 상관없는 올바른 순서로 존재하는 공통 문자 쌍의 개수를 의미합니다.\n  e.g. x = a**bcde**, y = **bcd**uv**e** \u0026rarr; LCS(x, y) = **bcde**\n  |x| - |y| - 2|LCS(x, y)| = 5 + 6 - 2*4 = 3 \u0026rarr; **distance = 3**\n\n  \u003ctip\u003e\n    x = ab, y = ba의 경우에는 LCS가 a or b 로 2개 생길 수도 있습니다.\n    이 경우의 x, y의 edit distance는 아무튼 2로 동일하긴 합니다.\n  \u003c/tip\u003e\n\n단, 클러스터링을 하더라도, 특정 클러스터가 어떤 그룹인지는 알 수 없습니다.\n사람이 직접 라벨링을 하거나, 데이터의 분포로 추측하는 수 밖에 없습니다.\n\n### Curse of Dimensionality\n\n그럼 단순하게 거리계산을 이용한 클러스터링? 쉬워 보입니다.\n하지만 현실은 차원의 저주 때문에 클러스터링이 제대로 이뤄지지 않습니다.\n\n차원의 저주란 고차원에서 보면 매우 달라보이는 두 데이터가 비슷하게 분류되는 문제를 의미합니다.\n예시와 함께 알아봅시다.\n\n구간 \\[0, 1\\] 사이에 1만개의 서로 다른 점이 있다고 가정해봅시다.\n0.1%, 즉 10개의 이웃한 점을 추출한다고 했을 때 각 차원별로 축의 몇%에 해당하는 범위의 점들이 포함될까요?\n\n1차원에서는 일직선 위의 0.1%, 즉, 축위의 0\\~0.001 사이의 점들이 비슷한 정도 0.1%에 해당하는 점들입니다.\n2차원에서는 평면위의 0.1%, 즉, 각 축위의 0\\~0.032 사이의 점들이 비슷한 정도 0.1%에 해당하는 점들입니다. (0.032${^2} \\approx$ 0.001)\nn차원에서는 n차원의 0.1%, 즉, 각 축위의 0\\~0.001$^{1/n}$ 사이의 점들이 비슷한 정도 0.1%에 해당하는 점들입니다. ((0.001$^{1/n}$)${^n}$ = 0.001)\n\n즉, 차원이 높아질수록 각 축에서는 더 넓은 범위에서 비슷하다고 판단하게 됩니다.\n10차원(n=10)의 경우에는 (0, 0, ... , 0)과 (0.5, 0.5, ..., 0.5)도 상위 0.1%로 비슷하다고 판단해 버립니다.\n\n### Clustrting Strategies\n\n클러스터링 전략은 크게 2가지로 나뉩니다.\n\n1. 계층적 클러스터링\n    1. bottom up\n        각 점이 클러스터 1개를 생성사고, 가까운(비슷한) 클러스터끼리 병합하여 커지는 방식\n    2. top down\n        하나의 단일 클러스터로 시작하여 클러스터를 분리해나가는 방식\n\n    ![231203-230112](/posts/final_02/231203-230112.png)\n\n    중심 포인트가 구분되지 않는다면 hierachical 방식이 더 좋습니다.\n\n2. 점 할당 클러스터링\n\n    하나의 점을 향하는 점들끼리 클러스터링 하는 방식 (e.g. k-means)\n\n    ![231203-230031](/posts/final_02/231203-230031.png)\n\n    중심 포인트가 구분된다면 point-assignment 방식이 더 좋습니다.\n\n또한, 데이터가 유클리드 공간에 표현할 수 있는 경우에는 거리를 L1, L2 norm과 같은 유클리드 거리로 계산하지만,\n유클리드 공간에 표현 불가능한 경우에는 거리를 Cosine, Jaccard, Edit-distance 등으로 거리를 계산합니다.\n\n---\n\n## Hierachical Clustering\n\n계층적 클러스터링 중에서 bottom-up 방식의 클러스터링에 대해 알아보겠습니다.\n이 경우에는 클러스터링을 할 때, 다음과 같은 의문점을 해결해야 합니다.\n\n1. 클러스터를 어떤식으로 표현하는가?\n2. 가까운(비슷한) 클러스터의 기준이 무엇인가?\n3. 합치는 과정을 언제 멈추는게 좋은가?\n\n이 경우에는 유클리드 공간과 비 유클리드 공간에서 정의되는 경우를 나누어서 살펴보겠습니다.\n\n### In Euclidean\n\n**1에 대한 해결방법**으로 centroid 개념을 도입하면 됩니다.\nCentroid란, 클러스터 내부 점들의 평균값으로 가상의 점을 생성하여 그 가상의 점을 centroid라고 합니다.\n\n**2에 대한 해결방법**으로, 유클리드 공간의 경우 centroid간 거리가 가장 짧은 클러스터가 가장 가까운 클러스터가 됩니다.\n즉, centroid가 가장 짧은 두 클러스터를 병합하면 됩니다.\n\n**3에 대한 해결방법**으로, 아래와 같은 경우에 병합을 중단하는게 좋습니다.\n- 클러스터의 직경이 너무 커질 경우\n- 클러스터의 밀도가 너무 작을 경우\n- 클러스터의 직경이나 밀도의 변화가 급작스럽게 변할 경우\n\n중단에 대한 평가법은 비 유클리드 공간에서도 동일하게 사용되기 때문에 비 유클리드 공간에서는 굳이 2번 언급하지 않겠습니다.\n\n### In Non-Euclidean\n\n비 유클리드 공간에서는 centroid를 정의할 수 없습니다.\n따라서 이를 대신할 방법이 2가지 정도가 존재합니다.\n\n- A - clusteroid\n- B - 클러스터 내부의 모든 점으로 표현\n\n따라서 여기서 또 케이스를 나누어 살펴봅시다.\n\n**1-A에 대한 해결방법**으로 clusteroid 개념을 도입합니다.\n가상의 점인 centroid와 다르게 clusteroid는 실제로 존재하는 포인트 중 하나를 대표값으로 설정하는 방법입니다.\n따라서 점들 중에서 어떤 점을 clusteroid로서 선택할지에 대한 여러 방법론이 존재합니다.\n\n![231204-123642](/posts/final_02/231204-123642.png)\n\n클러스터의 내부 점들이 아래와 같이 형성되었다고 가정해봅시다. (2, 3번은 outlier)\n\n1. inf-norm\n\n    다른 점들까지의 거리의 최댓값이 가장 작은 점을 선택하는 방법입니다.\n    이 경우에는 2의 점이 clusteroid로 선택이 될 것입니다.\n\n2. L1-norm\n\n    다른 점들까지의 평균 거리가 가장 짧은 점을 선택하는 방법입니다.\n    이 경우에는 1에 있는 점들 중 하나가 clusteroid로 선택이 될 것입니다.\n\n3. L2-norm\n\n    다른 점들까지의 거리 제곱의 평균이 가장 짧은 점을 선택하는 방법입니다.\n    이 경우도 2번과 유사하게 동작합니다.\n    하지만, 먼 거리일수록 패털티를 크게 부여한다는 점에서 다르게 사용될 수 있습니다.\n\n**2-A에 대한 해결방법**으로, 유클리드 공간에서의 2번 해결법과 동일합니다.\n다만, centroid가 아닌 clusteroid를 사용한다는 차이점만이 존재합니다.\n\n\n**1-B에 대한 해결방법**으로 별도의 대표값을 지정하는 것이 아닌, 클러스터 내부의 점들 그 자체를 평가 요소로 사용합니다.\n그렇다면 이 경우에는 거리를 측정하는 방법을 찾는게 가장 중요한 요소가 되겠죠?\n\n**2-B에 대한 해결방법**으로 아래와 같은 방법을 생각해볼 수 있겠습니다.\n\n- 클러스터 사이의 거리가 가장 짧은 점 2개를 기준으로 거리 측정\n- 클러스터 사이의 거리가 가장 긴 점 2개를 기준으로 거리 측정\n  \u0026rarr; 이 경우에는 클러스터를 병합했을 때의 생성되는 클러스터의 직경을 의미하며 작을 수록 좋습니다.\n- 모든 점들의 페어에 대한 거리의 평균으로 측정\n  \u0026rarr; 이 경우에는 클러스터간 점들의 평균 거리를 의미하며 역시 작을 수록 좋습니다.\n- 직경이나 평균 거리를 구한 뒤에 그 안에 들어있는 점들의 개수(밀도)를 측정\n  \u0026rarr; 이 경우에는 위 방식들과 다르게 새로운 클러스터를 마지한다고 가정하고 진행합니다. 밀도가 높을수록 좋습니다.\n\n이렇게 방법이 많은데 그럼 무슨 클러스터링 방법을 써야 할까요?\n답은, 알 수 없습니다.\n데이터의 케이스가 굉장히 다양하기 때문이죠..\n\n![231204-125101](/posts/final_02/231204-125101.png)\n\n이런 경우에는 centroid 방식으로는 잘 동작합니다. (색칠된 영역으로 클러스터가 병합됩니다)\n하지만, `클러스터 사이의 거리가 가장 짧은 점 2개를 기준으로 거리 측정`하는 방식으로는 잘 동작하지 않을 것입니다. (A, C 클러스터가 병합해버림)\n\n![231204-125304](/posts/final_02/231204-125304.png)\n\n이런 경우에는 반대로 centroid 방식으로는 잘 동작하지 않을 것입니다.\n\n여기서 알 수 있듯, 계층적 구조는 클러스터링에서 최적해를 보장하지 않는다는 것을 알 수 있습니다.\n\n---\n\n## K-means (Point-assignment) Clustering\n\nK-means 알고리즘은 point-assignment clustering 방식의 대표적인 알고리즘 입니다.\nk개의 클러스터를 찾는 알고리즘인데, 위의 계층적 클러스터링 방식과 마찬가지로 최적해를 보장하지는 않습니다.\n\n알고리즘의 동작 방식은 다음과 같습니다.\n\n1. 일단은 랜덤하게 k개의 중심을 정한다.\n2. 각 점들은 가장 가까운 중심으로 연결한다. (임시 클러스터 생성)\n3. 연결, 즉, 임시 클러스터가 생성되면 임시 클러스터의 점들의 실제 중심으로 중심을 이동시킨다.\n  여담으로, 여기서 말하는 중심은 `In Non-Euclidean - 1-A에 대한 해결방법 - L2-norm`과 비슷하게 거리의 제곱이 최소화 되는 곳을 중심으로 합니다.\n4. 2, 3 과정을 반복하며 클러스터의 centroid가 안정(수렴)되면 종료합니다.\n\n단, k-means 방식은 결과 또한 보장받을 수가 없는게, 초기값의 영향을 많이 받기 때문에 무한루프에 빠질 가능성이 있기 때문입니다.\n아래의 예시가 그러한 경우입니다.\n\n![231204-130321](/posts/final_02/231204-130321.png)\n\n따라서 이런 경우를 방지하기 위해 실제 점을 초기값으로 잡거나, k-means++ 방식을 사용합니다.\n\n\u003ctip\u003e\n  `K-means++`\n  \u003cbr /\u003e\n  랜덤 중심을 정할 때, 이미 선택된 랜점 중심을 고려해서 고르자는 아이디어에서 출발하는 개선 알고리즘 입니다.\n  이미 선택된 랜덤 중심으로부터 거리가 멀 수록 선택 확률을 높이는 방식으로 동작합니다.\n\u003c/tip\u003e\n\n### vs. Hierachical\n\n계층적 클러스터링과 비교했을 때, K-means의 장점은 거리 비교 횟수가 적다는 것입니다.\n계층적 클러스터링 방식은 점들마다 다른 점들의 개수 만큼의 비교 횟수가 필요합니다.\n하지만, k-means 방식은 점들마다 centroid의 개수 만큼의 비교 횟수만이 필요하기에 빠르게 군집화를 달성할 수 있습니다.\n\n### Getting the k right\n\n그렇다면 k 개수는 어느정도로 설정하는 것이 좋을까요?\n\n![231204-131006](/posts/final_02/231204-131006.png)\n\ncentroid 까지의 거리가 유의미한 수준으로 줄어드는 정도에서 멈추는 것이 좋습니다.\n즉, 거리가 줄어들긴 해도 유의미한 수준으로 줄어들지 않는다면 그 시점의 k의 개수를 선택하는 것입니다.\n\n![231204-131019](/posts/final_02/231204-131019.png)\n![231204-131033](/posts/final_02/231204-131033.png)\n![231204-131046](/posts/final_02/231204-131046.png)","slug":"univ_mmds/final_02","readingMinutes":17,"wordCount":1233},{"title":"LSH","description":"Locality-Sensitive Hashing과 응용에 대해 알아봅니다.","icon":"","image":"","tags":["LSH"],"draft":false,"date":"2023-12-03 / 15:48","content":"\n## LSH\n\nLSH는 비슷한 객체를 찾는 방식 중 하나로, 일반 해싱과 비슷하게 동작하지만, 큰 차이가 있습니다.\n\n일반 해싱은 데이터가 조금만 달라져도 아웃풋이 완전히 달라지는 반면,\nLSH는 해싱을 부분적으로 진행하기 때문에 조금만 달라지면 아웃풋도 조금만 달라지게 됩니다.\n\n예시를 통해 알아봅시다.\n\n![231203-203340](/posts/final_01/231203-203340.png)\n\nLSH는 해싱을 진행할 때, 전체 데이터를 해싱하는 것이 아닌, 전체 데이터를 b등분한 b개의 bands를 각각 해싱합니다.\n해싱된 band는 그 아웃풋에 해당하는 bucket에 담기게 됩니다.\n\n만약 두 문서가 비슷하다면 어떨까요?\n비슷한 두 문서는 높은 확률로 시그니처가 동일한 band를 갖고 있을 것입니다.\n즉, 비슷한 분서는 같은 bucket에 담기는 band를 공유하고 있을 것입니다.\n\n물론, 다른 입력에 대해 같은 아웃풋이 해싱에는 존재할 수 있습니다.\n따라서 가능한 많은 bucket를 확보하여 분류하는 것이 좋습니다.\n또는 각 band 별로 다른 해시 테이블을 사용하여 다른 버킷에 할당될 수 있도록 하는 것도 방법입니다.\n\n그런데 LSH가 얼마나 효율적인지도 알아봐야겠죠?\n\n10만개의 문서가 각각 길이 100의 시그니처를 갖고있다고 가정해봅시다.\n80% 비슷한 문서, 즉 시그니처가 80개 이상 일치하는 비슷한 pair를 찾고싶다면, 일반적인 방법으로는 아래와 같은 연산 횟수가 필요합니다.\n\n$$\n100000 + ... + 2 + 1 = 100001 * 50000 \\approx 5B\n$$\n\n즉 10만개의 문서을 일일이 비교하려면 약 50억 번의 비교 연산이 필요합니다.\n\n하지만, LSH로 우선 비교 대상을 줄인다면?\nLSH로 10만 번의 연산이 필요하고, 비교 대상이 100개로 줄어든다면 아래와 같은 연산 횟수가 필요합니다.\n\n$$\n100000 + 100 + ... + 2 + 1 = 100000 + 5050 = 105050\n$$\n\nLSH를 사용하는 것 만으로 연산 횟수가 기하급수적으로 줄어든 것을 확인할 수 있었습니다.\n하지만, 앞서 언급했 듯, 다른 band도 같은 bucket에 들어갈 확률이 있습니다.\n\n그렇기에 LSH는 false negative가 발생할 확률도 있기 때문에, 같은 bucket에 들어간 candidate pair에 대해 실제로도 비슷한지 전 시그니처를 검사하는 과정을 거쳐 유사도를 판단하는 게 좋습니다.\n(LSH는 전처리 과정일 뿐!)\n\n### Confidence\n\n그렇다면, LSH의 신뢰도는 얼마나 될까요?\n\n5int/band 단위로 길이 100의 시그니처를 20개의 bands로 분할하고, LSH를 적용한다고 가정해봅시다.\n\n문서 $C_1$, $C_2$가 80% 확률로 비슷할 때, 한 band가 같은 버킷에 들어갈 확률은 다음과 같습니다.\n\n$$\n(0.8)^5 \\approx 0.328\n$$\n\n그렇다면, 20개의 모든 밴드가 다른 버킷의 들어갈 확률은 다음과 같아집니다.\n\n$$\n(1-0.328)^20 \\approx 0.00035\n$$\n\n즉, 문서 $C_1$, $C_2$가 80% 확률로 비슷하다면 약 99.99965%의 확률로 최소한 하나의 bucket에 두 band가 들어갈 것입니다.\n\n40% 확률로 비슷한 경우는 어떨까요?\n\n$$\n(0.4)^5 \\approx 0.01 \\\\\n(1-0.01)^20 \\approx 0.82\n$$\n\n즉, 40% 확률로 비슷하다면 약 18%의 확률로 최소한 하나의 bucket에 두 band가 들어갈 것입니다.\n\n40%만 비슷해도 비슷하다고 판단해야 하는 시스템의 경우 88%의 케이스가 False positive가 되어버립니다.\n그럼에도 불구하고 50억번 비교하는 것 보다는 나을 것입니다.\n\n### Analysis\n\n위의 경우 80% 유사도를 검사할 때는 신뢰도가 매우 높았지만, 40%을 검사할 때는 신뢰도가 상당히 낮았습니다.\n신뢰도는 b(bands)와 r(ints/band)의 값에 영향을 받는데, 각각의 파라미터가 어느정도일 때 유사도에 따른 신뢰도는 어떻게 나오는 걸까요?\n\n![231203-210605](/posts/final_01/231203-210605.png)\n\n우선 band가 1개일 때의 신뢰도 입니다.\nband가 1개라는 것은 그냥 데이터 전체를 해싱하는 것과 같습니다.\n\n![231203-210859](/posts/final_01/231203-210859.png)\n\n다음은 band가 b개이고, r ints/band 일 때의 일치율 s에 따른 신뢰도 입니다.\n$$\n1 - (1-s^r)^b\n$$\n$(1/b)^{1/r}$ 지점에서 신뢰도가 급격하게 증가하는 모습을 볼 수 있습니다.\nb=20, r=5일 때 약 55% 일치율 지점에서 급격하게 증가합니다.","slug":"univ_mmds/final_01","readingMinutes":7,"wordCount":474},{"title":"Finding Similar Items","description":"유사도 높은 문서를 찾아내는 방법을 알아봅니다.","icon":"","image":"","tags":["Shingling","Minhashing","Jaccard Similarity"],"draft":false,"date":"2023-10-20 / 22:12","content":"\n생김새가 비슷한 사이트를 묶거나, 표절 검사를 하거나, 비슷한 내용의 뉴스를 클러스터링 하는 등 여러 분야에서 사용될 수 있는 기술에 대해 설명합니다.\n\n\u003cnotice\u003e\n  생김새가 비슷한 문서를 찾아내는 기술이지, 비슷한 토픽을 찾아내는 기술은 아닙니다.\n\u003c/notice\u003e\n\n아래의 단계를 거쳐 비슷한 문서를 찾게 되는데, 각 단계에 대한 세부적인 내용은 추후에 설명합니다.\n\n1. `Shingling`을 통해 데이터(문서)를 집합으로 변환\n2. `Minhashing`을 통해 큰 집합을 작은 시그니처로 변환\n3. `LSH`를 통해 시그니처를 분류 후 비슷한 집합 찾기\n\n## Jaccard Similarity\n\n세부내용 설명 전 개념 하나만 짚고 넘어가자.\n유사도를 검사할 때, 다음과 같은 경우를 고려해보자.\n\nA, B 모두 메이져한 게임들을 주로 플레이하고, A는 RPG를, B는 FPS를 주로 플레이한다고 가정하자.\n이 때, 마이너한 장르의 게임을 예시로 들며 유사도를 검사하는데, A, B 모두 해당 게임을 보유하지 않는다고 두 사람의 유사도가 높다고 이야기 할 수 있을까?\n두 사람은 그런 마이너한 장르의 게임에 관심이 없어서 갖고있지 않을 뿐인데, 둘 다 갖고있지 않다고 두 사람의 플레이스타일이 유사하다고 판단하는 것은 무리가 있다.\n\n따라서 이런 유사도 파악의 오류를 해결하기 위해 Jaccard 유사도를 사용하여 유사도를 측정하게 된다.\n\n$$\nSim(C_1, C_2) = \\frac{|C_1 \\cap C_2|}{|C_1 \\cup C_2|}\n$$\n\n즉, **두 사람 중 한 사람이라도 해당 게임을 보유하고 있는 경우에만 두 사람이 동시에 해당 게임을 보유하는가**로 유사도를 검사하는 것이다.\n\n---\n\n## Shingling\n\n문서의 유사도를 측정할 때 그 기준이 되는 토큰을 생성하는 방법입니다.\n`k-shingle` 과 같은 용어를 사용하는데, 이는 k개의 문자로 이루어진 shingle을 의미합니다.\n실제로 비슷한 문서를 싱글링 했을 때 집합의 원소도 일치하는 부분이 매우 많습니다.\n\n예로 들어 \\\"The dog which chased the cat\\\" 이라는 문장이 있다고 했을 때, 여기서 2-shingle를 구하면 다음과 같습니다.\n\n\u003e th(보통 소문자로 변환), he, e_, _d, do, og, ...\n\n하지만, 2-shingle로 하면 th, he, do와 같이 문장으로 볼 때는 상당히 유니크한 의미를 갖는 문장이 이렇게 아무데서나 나올법한 shingle이 되어버립니다.\n따라서 보통은 `8~10`-shingle로 하는 것이 적당합니다.\n\n### Tokens\n\n10-shingle을 사용하는 경우에는 최대 $27^{10} \\approx 200조$ 개의 싱글이 생성되게 됩니다.\n이를 메모리상에서 관리하는 것은 현실적으로 불가능한 일입니다.\n\n따라서 싱글을 해싱하여 4bytes의 자료형으로 변환하여 `Token`으로서 사용하게 됩니다.\n4bytes로 최대 약 42억개의 서로 다른 싱글을 표현할 수 있습니다.\n물론 다른 싱글에 대해 같은 토큰이 생성될 수 있지만, 그리 빈번한 경우는 아닐 것이며, 효율상 이 방법이 더 좋습니다.\n\n즉, 같은 토큰을 보유한 문서가 있다면, 그 문서들은 같은 싱글을 갖고있다는 얘기이므로, 유사도가 있다고 판단할 수 있겠습니다.\n\n---\n\n## Minhashing\n\nMinhashing을 알아보기 전, 데이터를 표현하는 행렬을 읽는 법을 알고가자.\n\n| (token) | $C_1$ | $C_2$ |\n|---|---|---|\n| a | 0 | 0 |\n| b | 1 | 0 |\n| c | 0 | 1 |\n| d | 1 | 1 |\n\na 토큰(싱글)은 문서(Column) 1, 2에서 모두 없다는 뜻이고, b는 문서 1에서만 갖고있다는 뜻으로 해석하면 된다.\n참고로 위의 경우 두 문서의 Jaccard 유사도는 **1/3**이다. (a는 둘 다 없기에 비교대상이 아니다)\n\n### Permute the rows\n\n우선 행을 핸덤으로 뒤죽박죽 섞는다.\n섞는다는 것은 실제로 맊 섞는다는 것이 아닌, 탐색 순서를 섞는다는 것을 의미하는데, 구현 관점에서 해싱을 돌리는 것과 같다.\n예시를 보며 이해해보자.\n\n| (row) | $C_1$ | $C_2$ | $C_3$ |\n|---|---|---|---|\n| 1 | 0 | 1 | 1 |\n| 2 | 1 | 0 | 1 |\n| 3 | 0 | 1 | 0 |\n| 4 | 0 | 0 | 0 |\n| 5 | 1 | 0 | 1 |\n\n$h_1(x) = x \\% 5$ 해시함수를 적용하면 탐색 순서는 다음과 같아진다.\n\n\u003e **5**(0) \u0026rarr; **1**(1) \u0026rarr; **2**(2) \u0026rarr; **3**(3) \u0026rarr; **4**(4)\n\n$h_2(x) = (2x+1) \\% 5$ 해시함수를 적용하면 탐색 순서는 다음과 같아진다.\n\n\u003e **2**(0) \u0026rarr; **5**(1) \u0026rarr; **3**(2) \u0026rarr; **1**(3) \u0026rarr; **4**(4)\n\n### Create signature\n\n탐색 순서에 맞게 처음으로 1(토큰 보유)을 만나는 탐색 순서를 기록한다.\n\n\u003e $h_1$를 적용한 탐색시 생성되는 Singature matrix\n\u003e [1, 2, 1]\n\u003e\n\u003e $h_2$를 적용한 탐색시 생성되는 Singature matrix\n\u003e [1, 3, 1]\n\n즉, $C_1$에 대한 시그니처는 11, $C_2$는 23, $C_3$은 11이 된다.\n\n여기서 중요한 특징이 있는데, 시그니처의 길이가 길어질 수록(무작위 순서에 의한 탐색 횟수가 늘어날 수록) 시그니처가 일치할 확률이 Jaccard 유사도와 확률이 같아진다.\n그 이유를 간단한 예시로 이해해보자.\n\n우선, $C_2$과 $C_3$의 Jaccard 유사도는 **1/4**이다.\n그런데 이 때, Singature가 같아지는 경우는 무엇일까? 바로 **최초로 1이 나오는 시점이 같다**는 이야기이다.\n즉, 같은 row에 대해 둘 다 1이 들어가 있는 row를 고를 확률과 같아진다.\n둘 다 0인 경우를 제외하면 4개 중에 둘 다 1인 row는 1개 존재하기에 Jaccard 유사도와 동일한 **1/4** 확률을 갖는다.\n\n![231020-235719](/posts/mid_05/231020-235719.png)\n\n이해를 돕기 위해 다른 예시도 보자.\n\n원래대로라면 생성되는 모든 토큰(42억개)에 대해 유사도를 검사 했어야 했다.\n하지만, 시그니처를 만드는 과정에서 무작위 순서로 탐색을 진핼할 때, 탐색개수를 제한을 걸면 검사 시간을 줄일 수 있다.\n예로 들어 해시함수의 결과를 50까지만 검색한다면 42억개의 항목에 대해 검사를 진행하지 않아도 된다. \n\n이 때 검사 개수를 줄인 만큼 서로다른 해시를 여러 번 진행하면 신뢰도 역시 어느정도 확보할 수 있다.\n예로 들어 서로 다른 해시함수 100개를 적용한다면, 시그니처의 길이가 100으로 결정되는데, 이 길이는 충분히 신뢰도를 확보할 수 있을 것이다.\n즉, 42억개에서 100개로 압축되는 효과가 발생하는 것이다.\n\n위의 사진을 예시로 실제 Jaccard 유사도와 시그니처 유사도를 비교해보며 시그니처 길이가 신뢰도에 어느정도 영향을 주는지 알아보자.\n\n\u003e Column 1, 2\n\u003e Jaccard Similarity: **1/4**\n\u003e Singature Similarity: **1/3**\n\u003e\n\u003e Column 2, 3\n\u003e Jaccard Similarity: **1/5**\n\u003e Singature Similarity: **1/3**\n\u003e\n\u003e Column 3, 4\n\u003e Jaccard Similarity: **1/5**\n\u003e Singature Similarity: **0**\n\n### implement\n\n의사코드로 구현해보고 시그니처 생성과정을 살펴보자.\n\n```cpp:의사코드\n// 처음에 무한대로 초기화\nfor (all i and c) M(i, c) = inf;\n\n// 각 행에 대해 반복하는데, 여기에 탐색개수 50개와 같은 제한을 걸 수 있음\nfor (each row r) {\n  for (each hash function h_i) {\n    compute h_i(r);\n  }\n  for (each column c) {\n    // 탐색지점에 1이 있는 경우\n    if (c has 1 in row r) {\n      for (each hash function h_1) {\n        // 저장된 시그니처보다 새 탐색값이 작은 경우에만 업데이트\n        if (h_i(r) is smaller them M(i, c)) {\n          M(i, c) = h_i(r);\n        }\n      }\n    }\n  }\n}\n```\n\n![231021-001859](/posts/mid_05/231021-001859.png)","slug":"univ_mmds/mid_05","readingMinutes":11,"wordCount":927},{"title":"Association Rules","description":"빅데이터에서 연관 규칙을 찾아내는 방법에 대해 알아봅니다.","icon":"","image":"","tags":["Association Rules","Support","Confidence","Interest"],"draft":false,"date":"2023-10-20 / 20:08","content":"\n## Application\n\n연관 규칙을 응용할 수 있는 분야를 살펴보면서 대략적인 이해와 필요성에 대해 알아보자.\n\n![231020-201233](/posts/mid_04/231020-201233.png)\n\n장을볼 때 각 장바구니에 어떤 물건을 샀는지를 나타내는 표이다.\n이 표를 간단하게 분석해보면, `Milk`를 산 사람은 대체로 `Coke`를 사는 경향이 있고, `Diaper, Milk`를 동시에 산 사람은 대체로 `Beer`를 산 경향이 있는걸로 보인다.\n이렇게 사람들의 구매 경향을 분석할 때 사용하기도 한다.\n\n또한 문서 상에서 **\\{the\\} \u0026rarr; \\{cat\\}** 이라는 규칙이 있다면 the 라는 단어 뒤에는 대체적으로 cat 이라는 단어가 나온다는 뜻으로, 자연어처리시 문법을 파악하고 학습시키는데 도움이 될 수도 있다.\n\n그 외에도 여러 분야에서 활용될 수 있지만, 섣부른 일반화는 안된다.\n예로 들어 **비타민C를 많이 먹는 사람들은 불면증을 겪는 경향이 있다**는 규칙을 발견했다면, **비타민C를 안먹는 경우**에도 불면증 경향이 있는지 검사해봐야 확실해는 것이다.\n\n## Frequent Itemset\n\nFrequent Itemset을 구하는 방법은 [**`저번 포스트`**](https://wjlee611.github.io/blog/univ_mmds/mid_03)에서 알아봤으니, 이젠 용어과 수식을 통해 연관 규칙을 정의하는 것을 알아보자.\n\n### Support\n\n**Support for itemset I** 라고 한다면 itemset I가 등장한 횟수를 의미한다.\n전체 basket에서 itemset I가 등장한 횟수를 카운트 하면 된다.\n이 때, Support threshold S 보다 크다면 빈번하다고 판단하게 되는 것이다.\n\n| Baskets | m(ilk), c(oke), p(epsi), b(read), j(am) |\n| --- | --- |\n| $B_1$ = **\\{m, c, b\\}** | $B_2$ = **\\{m, p, j\\}** |\n| $B_3$ = **\\{m, b\\}** | $B_4$ = **\\{c, j\\}** |\n| $B_5$ = **\\{m, p, b\\}** | $B_6$ = **\\{m, c, b, j\\}** |\n| $B_7$ = **\\{c, b, j\\}** | $B_8$ = **\\{b, c\\}** |\n\n예로 들어 위와 같이 목록들이 존재하고, Support threshold가 `3 baskets` 라고 주어진다면,\nFrequent itemset은 아래와 같이 나오게 된다.\n\n\u003e **\\{m\\}, \\{c\\}, \\{b\\}, \\{j\\}, \\{m, b\\}, \\{b, c\\}, \\{c, j\\}**\n\n## Association Rules\n\n**특정 집합($I$)이 등장할 때 $j$ 하는 경향이 있다** 라는 연관 규칙을 수식화 하면 아래와 같이 표현이 가능하다.\n\n\u003e $\\{i_1, \\; i_2, \\; ,... \\; , i_k\\}$ \u0026rarr; $j$\n\n### Confidence\n\n이 떄, 그 경향에 대한 신뢰도, `Confidence`는 아래와 같이 수식화 할 수 있다.\n\n$$\nconf(I \\rightarrow j) = \\frac{support(I \\cup j)}{support(I)}\n$$\n\n즉 조건부에 해당하는 itemset이 등장할 확률 기반으로 itemset + j 가 동시에 등장할 확률을 구하면 되는 것이다.\n\n### Interest\n\n하지만 신뢰도가 높다고 반드시 의미있는 규칙이 발견된 것은 아니다.\n\n예로 들어 **X \u0026rarr; milk** 라는 규칙을 발견했다고 가정하자.\n그러나, 굳이 X가 아니더라고 그냥 milk는 많이 사기때문에 둘 사이에 연관성이 깊다고 판단하기에는 무리가 있다.\n\n이 떄문에 `Interest`의 개념이 존재한다.\n\n$$\nInterest(I \\rightarrow j) = | conf(I \\rightarrow j) - Pr[j] | \\\\\nPr[j] = \\frac{support(j)}{표본 \\; 수}\n$$\n\n흥미도는 I 신뢰도에서 j가 등장할 확률을 뺀 값의 절댓값과 같다.\n\n보통 해당 값이 `0.5보다 크다`면 해당 규칙이 의존성이 있다는 의미가 된다.\n만약 `-0.5보다 작은` 경우에도 의존성이 있다는 의미가 있는데 이 경우에는 **I, j를 둘 다 사는 경우는 없다**는 뜻으로 해석할 수 있다.\n\n| Baskets | m(ilk), c(oke), p(epsi), b(read), j(am) |\n| --- | --- |\n| $B_1$ = **\\{m, c, b\\}** | $B_2$ = **\\{m, p, j\\}** |\n| $B_3$ = **\\{m, b\\}** | $B_4$ = **\\{c, j\\}** |\n| $B_5$ = **\\{m, p, b\\}** | $B_6$ = **\\{m, c, b, j\\}** |\n| $B_7$ = **\\{c, b, j\\}** | $B_8$ = **\\{b, c\\}** |\n\n위애서 예시로 든 baskets에서 다음과 같은 연관 규칙을 찾았다고 해보자.\n\n\u003e **\\{m, b\\} \u0026rarr; c**\n\u003e\n\u003e $support(\\{m, b\\} \\cup c)$ = **2** (m, b, c 동시 등장 횟수)\n\u003e $support(\\{m, b\\})$ = **4** (m, b 동시 등장 횟수)\n\u003e $conf(\\{m, b\\} \\rightarrow c)$ = 2/4 = **0.5**\n\u003e $Interest(\\{m, b\\} \\rightarrow c)$ = | 0.5 - 5/8 | = **1/8**\n\n즉, 이 경우에는 Interest가 낮기 때문에 그다지 의미 없는 규칙이라는 뜻이다.\n\n### Mining Association Rules\n\n1. 모든 빈발 항목 집합 I를 찾는다.\n  (이건 [**`이전 포스트`**](https://wjlee611.github.io/blog/univ_mmds/mid_03)에서 찾는 법을 다룸)\n\n2. 규칙 생성\n\n이제 규칙을 생성하는 방식을 알아보자.\n\n우선 생성된 빈발 항목 집합 I의 부분집합을 이용해서 생성 가능한 모든 연관 규칙을 만든다.\n예로 들어 **I = \\{a, b, c, d\\}** 라면, **\\{a, b, d\\} \u0026rarr; c, \\{a, b\\} \u0026rarr; \\{c, d\\}** 등등과 같이 모든 조합에 대해 만들어 주는 것이다.\n\n그 다음은 생성된 모든 규칙에 대해 Confidence, Interest를 분석해서 의미있는 규칙만 남도록 걸러내면 된다.\n여기서 특정 규칙을 검사하고 나면 나머지 특정 규칙들은 검사할 필요가 없어지는 최적화가 가능한데, 그 이유를 알아보자.\n\n예로 들어 **\\{a, b, c\\} \u0026rarr; d** 의 confidence가 threshold 이하라면 **\\{a, b, c\\}** 의 부분집합이 조건부가 되는 규칙들(**\\{a, b\\} \u0026rarr; \\{c, d\\}**, **\\{b\\} \u0026rarr; \\{a, c, d\\}**, ...)은 검사를 진행할 필요가 없어진다.\n왜냐하면 아래의 식을 잘 살펴보자.\n\n$$\nconf(I \\rightarrow j) = \\frac{support(I \\cup j)}{support(I)}\n$$\n\n여기서 동일한 빈발 항목 집합에 대해 생성된 규칙이면 분자는 동일하다는 것은 자명하다.\n즉, 분모만 변화하게 되는데, 원소의 개수가 줄어들 수록 분모의 값은 필연적으로 같거나 커질 수 밖에 없다.\n그렇기에, confidence는 반드시 같거나 작아질 수 밖에 없는 것이다. (하물며 threshold와 비교하면? 분명 더 작을거다.)\n\n| Baskets | m(ilk), c(oke), p(epsi), b(read), j(am) |\n| --- | --- |\n| $B_1$ = **\\{m, c, b\\}** | $B_2$ = **\\{m, p, j\\}** |\n| $B_3$ = **\\{m, c, b, n\\}** | $B_4$ = **\\{c, j\\}** |\n| $B_5$ = **\\{m, p, b\\}** | $B_6$ = **\\{m, c, b, j\\}** |\n| $B_7$ = **\\{c, b, j\\}** | $B_8$ = **\\{b, c\\}** |\n\n마지막으로 실제로 연관 규칙을 찾아보며 마무리해보자.\nthreshold = 3, confidence = 0.75 로 제한한다고 가정하자.\n\n\u003e Frequent itemsets: \n\u003e **\\{b, m\\} \\{b, c\\} \\{c, m\\} \\{c, j\\} \\{m, c, b\\}**\n\n| Generate rules | | | |\n| --- | --- | --- | --- |\n| ~~b \u0026rarr; m [c=0.67]~~ | b \u0026rarr; c [c=0.83] | ... | ~~b,c \u0026rarr; m [c=0.6]~~ |\n| m \u0026rarr; b [c=0.8] | c \u0026rarr; b [c=0.83] | | ~~b \u0026rarr; c,m (검사 필요 없음)~~ |\n| | | | ~~c \u0026rarr; b,m (검사 필요 없음)~~ |\n| | | | c,m \u0026rarr; b [c=1] |\n| | | | b,m \u0026rarr; c [c=0.75] |\n| | | | ~~m \u0026rarr; b,c [c=0.6]~~ |\n이후에 interest도 진행\n\n### Compacting the output\n\n생성되는 연관 규칙이 너무 많기에 이를 압축하는 방식도 있다.\n\n1. Maximal frequent itemsets\n  threshold 기준으로 압축한다.\n2. Closed itemsets\n  support 기준으로 압축한다.\n\n다음 표를 보면서 이해해보자.\n(Yes인 경우에만 연관 규칙을 출력한다는 뜻이다)\n\n| Itemset | Support | Maximal | Closed |\n| --- | --- | --- | --- |\n| A | 4 | No | No |\n| B | 5 | No | Yes |\n| C | 3 | No | No |\n| AB | 4 | Yes | Yes |\n| AC | 2 | No | No |\n| BC | 3 | Yes | Yes |\n| ABC | 2 | No | Yes |\n**Threshold = 3**\n\n`Maximal 기준`\n- C를 보면 support가 threshold보다 크지만 출력하지 않는다.\n그 이유는 C의 superset BC가 `frequent 해서` 이미 출력하기 때문에 중복해서 출력하지 않는 것이다.\n- 반대로 AB를 보면 support가 threshold보다 커서 출력한다.\n그 이유는 AB의 superset ABC가 `frequent 하지 않기 때문`에 출력해야하기 때문이다.\n\n\n`Closed 기준`\n- C를 보면 support가 threshold보다 크지만 출력하지 않는다.\n그 이유는 C의 superset BC의 `support와 같기 때문`에 출력하지 않는 것이다.\n- 반대로 AB를 보면 support가 threshold보다 커서 출력한다.\n그 이유는 AB의 superset ABC의 `support가 보다 작기 때문`에 출력하는 것이다.","slug":"univ_mmds/mid_04","readingMinutes":11,"wordCount":1147},{"title":"Frequent Itemset","description":"빈발 항목 집합을 구하는 방법을 알아봅니다.","icon":"","image":"","tags":["Frequent Itemset","A-Priroi","PCY","Random Sampling","SON","Toivonen"],"draft":false,"date":"2023-10-19 / 16:33","content":"\n## Naive Algorithm\n\n우선 나이브한 방법으로 빈발 항목 집합을 찾는 방법부터 알아보자.\n처음에는 frequent pair를 찾는 것을 목표로 하고, 이후에 원소의 개수가 더 많은 집합을 찾는 방식으로 확장하자.\n\n간단하게 요약하면 아래의 두 단계에 걸쳐 모든 pair를 생성한다.\n\n1. 가능한 모든 조합의 쌍 생성\n  n개의 아이템이 들어있는 Basket에서는 `n(n-1)/2` 개의 조합 쌍이 생성된다.\n2. 해당 조합 쌍이 동시에 등장하는 경우 1씩 카운트하며 개수를 센다.\n\n이 방식은 구현이 제일 간단하지만 치명적인 문제가 있다.\n개수를 `4bytes`의 int형으로 저장한다고 가정하면 n개의 아이템이 존재하는 Basket에 대해 `2n(n-1)bytes`의 메모리 공간이 할당되어야 하는데, 이런 크기의 메모리 공간을 할당할 수 없을 뿐더러, 존재하지도 않은 페어의 메모리 공간을 할당해야만 하는 문제점이 있다.\n\n### Triples\n\n이런 한계를 극복하기 위해 원소를 triples로 관리하는 기법도 있다.\n`[i, j, c]` 로 관리하는 기법인데, **\\\"\\{i, j\\} 페어가 c번 등장함\\\"** 이라는 의미로 관리하는 것이다.\n이렇게 하면 하나의 페어당 12bytes가 들어가긴 하지만, 존재하지도 않은 페어에 대한 메모리 공간 할당은 방지할 수 있다.\n\n하지만 메모리 주소 관리를 위해 별도의 `해시 테이블`을 할당해야 하기에 그다지 메리트가 크지는 않다.\nTriples 방식이 더 효율적으로 작동하기 위해서는 가능한 모든 페어 조합 수의 1/3 수준으로 실제로 등장하는 페어수가 존재해야 한다.\n\n---\n\n## A-Priori Algorithm\n\n페어가 메인 메모리에 올라갈 정도로 적다면 나이브한 방식을 사용하는것이 좋다.\nBasket을 한 번만 읽어도 되는, 1pass만에 빈발 항목 집합을 찾을 수 있으니 속도가 빠르기 때문이다.\n\n\u003ctip\u003e\n  `pass`\n  Basket(파일)을 처음부터 끝까지 읽는 횟수로, Disk I/O의 cost가 큰 만큼 pass 횟수에 따라 알고리즘의 성능을 평가하는 요소로 작동한다.\n\u003c/tip\u003e\n\n하지만, 그렇지 않은 대다수의 경우에는 다른 방식을 고안해야 한다.\nA-Priori 알고리즘의 경우에는 2pass로 pair를 찾을 수 있지만, 그 대신 메모리 효율성이 극대화되어 매우 큰 파일도 메모리에 적재할 수 있다.\n하지만 이게 어떻게 가능한 것일까?\n\n기본적인 아이디어는 이렇다.\n이 파일에는 아이템이 **a, b, c** 이렇게 존재한다고 해보자.\n만약 **\\{a, b\\}** 가 10번 등장했다면, 진 부분집합 **\\{a\\}, \\{b\\}** 역시 10변 이상 등장했을 것이다.\n반대로 말하면 **\\{a\\}, \\{b\\}** 가 10번도 안나왔다면, **\\{a, b\\}** 역시 10번도 안나올 것이다.\n\n따라서 빈발 항목 집합을 세기 전에 우선 threshold보다 큰 경우에만 빈번하다고 기준을 정의하고 시작한다.\n\n### Pass 1\n\npass 1에서는 우선 파일을 읽어보며 개별적인 아이템 개수부터 세어본다.\n이 때, 아이템 개수가 threshold보다 큰 경우에만 다음 pass에서 고려하게 된다.\n\n![231019-205437](/posts/mid_03/231019-205437.png)\n\n참고로 pass 2에서 빈번하게 등장한 아이템에 접근하기 위해 빈번하게 등장한 아이템들의 주소를 저장하기 위해 메모리 공간을 약간 할당한다.\n\n### Pass 2\n\npass 2에서는 pass 1에서 통과한 아이템들을 이용해서 페어를 생성한다.\n그리고 나이브한 방법과 마찬가지로 파일을 읽으면서 등장 횟수를 카운트한다.\n\n이 방식이 훨씬 효율적인게, 만약 pass 1에서 읽어야 할 아이템의 개수가 1/10 으로 줄었다면,\npass 2에서 생성되는 pair의 개수는 1/100 수준으로 줄어든다.\n따라서 메모리 효율성이 거의 100배 증가하는 것이다.\n\n### Frequent Triples\n\npair에서 확장되어 원소의 개수가 3개, 4개인 경우의 처리 방식도 알아보자.\n근데 사실 별 거 없다. 그냥 앞에서 봤던 방법의 반복이다.\n\n빈번하게 등장한 페어를 이루는 아이템들로 triple을 만든다.\n이후 각 triple의 진 부분집합이 빈번하게 등장한 pair인 경우에만 파일을 읽어보며 세어보면 된다.\n\n예시들 들어 이해해보자.\n\n\u003e $C_1$ = \\{\\{b\\} \\{c\\} \\{j\\} \\{m\\} \\{n\\} \\{p\\}\\}\n\u003e threshold보다 많이 등장한 원소는 아래 4개라고 해보자.\n\u003e $L_1$ = \\{b, c, j, m\\}\n\u003e $L_1$을 이용해서 다름 pass 진행\n\u003e \n\u003e $C_2$ = \\{\\{b, c\\} \\{b, j\\} \\{b, m\\} \\{c, j\\} \\{c, m\\} \\{j, m\\}\\}\n\u003e threshold보다 많이 등장한 원소는 아래 4개라고 해보자.\n\u003e $L_2$ = \\{\\{b, c\\} \\{b, m\\} \\{c, j\\} \\{c, m\\}\\}\n\u003e $L_2$을 이용해서 다름 pass 진행\n\u003e\n\u003e $C_3$ = \\{\\{b, c, m\\} \\{b, c, j\\} \\{b, m, j\\} \\{c, m, j\\}\\}\n\u003e 이 때 \\{b, c, j\\} \\{b, m, j\\} \\{c, m, j\\}의 부분 집합은 $L_2$에 포함되지 않으니 세어볼 필요 없음 (반드시 threshold보다 적게 등장할 것)\n\n즉, A-Priori 알고리즘은 k-pass 단계에서 k-tuple의 집합을 생성하게 되는데,\n일반적으로 k=2일 때, 메모리 사용량이 가장 많다.\n\n---\n\n## PCY Algorithm\n\nPark-Chen-Yu 알고리즘으로 A-Priori 알고리즘의 pass 1에서 메모리의 빈 공간을 활용하여 탐색 효율을 높인 알고리즘이다.\n그 이후의 과정은 A-Priori와 같으니, pass 1에서의 메모리 관리 방법에 대해서만 알아보자.\n\n![231019-211632](/posts/mid_03/231019-211632.png)\n\n### Bucket's Hash Table\npass 1에서 개별적인 아이템 등장 횟수를 카운트 할 때, 동시에 아이템으로 만들 수 있는 pair의 개수도 동시에 카운트 하는 것이다.\n이 때 페어를 해싱하여 버킷으로 만들고, 그 버킷을 Hash table for pairs에 최대한 가득 채운다.\n\n예로 들어 a, b, c의 개수를 세어보면서 \\{a, b\\} \\{b, c\\} \\{a, c\\}를 해싱한 주소에 등장할 때 마다 1씩 카운트 하는 것이다.\n만약 \\{a, b\\} \\{a, c\\} 의 해시 결과가 같은데, 해당 pair을 해시한 곳의 값이 threshold보다 작다면 pass 2에서 \\{a, b\\} \\{a, c\\} 를 셀 필요가 없다는 뜻이된다.\n\n그럼에도 불구하고 pass 2에서는 파일을 한 번 더 탐색을 해야만 하는데, 버킷만으로 pair가 threshold보다 크다고 단정지을 수 없는 이유는 해시의 특성 때문이다.\n다른 입력에 대해 같은 출력이 나올 수 있는 해시는 여러 pair가 하나의 버킷에 카운트 될 수 있음을 시사한다.\n즉, 버킷이 threshold보다 작다면 해싱후 그 버킷을 가리키는 pair는 세어볼 필요가 없지만,\nthreshold보다 큰 경우에는 threshold보다 작은 값이 여러개 모여 threshold보다 커졌을 가능성이 있기 때문에 다시 파일을 읽어보며 확인을 해봐야 하는 것이다.\n\n### Bit-vector (bitmap)\n\n아무튼, pass 1에서 pair의 해싱을 통한 버킷이 저장된 해시 테이블을 만들어 추후 파일 탐색시 검사해야 할 pair의 수를 줄이게 되는데,\n해시 테이블을 암축하지 않으면 pass 2로 넘어갈 수 없다. (메모리에 꽉 차게 할당했기 때문)\n어떻게 압축해야 필요한 정보를 유지할 수 있을까?\n\n우리가 필요한 정보는 n번째 버킷이 threshold보다 많이 등장했는지(1) 아닌지(0) 이다.\n따라서 해시 테이블에 n번째 버킷이 threshold보다 크다면 1, 아니면 0으로 압축할 수 있다.\n4bytes(32bits)에서 1bit로 압축되는 셈이다.\n\n그리고 이제 pass 2에서 \\{b, c\\}를 파일에서 몇 번 등장하는지 세어보기 전에 우선 해싱을 하여 bitmap에 해당 해시의 위치가 1이면 실제로 세어보고 0이면 셀 필요 없이 threshold보다 작다는 뜻이 된다.\n\n---\n\n## Random Sampling\n\n지금까지 알아본 빈번 항목 집합을 찾는 방식은 k-tuple의 개수를 세어보기 위해서는 k-pass를 거쳐야만 했다.\n이번부터 알아볼 알고리즘은 단 2-pass만에 세어볼 수 있는 방식을 알아볼 것이다.\n\n랜덤 샘플링 기법은 파일을 메모리에 올릴 수 있을 만큼만 적당히 샘플링 해와서 모든 카운트 과정을 메모리 내부에서 해결하는 것이다.\n하지만, 샘플링 비율만큼 실제 데이터 양도 줄어들기 때문에 threshold도 샘플링 비율만큼 줄여서 측정한다.\n\n하지만 이 경우에는 False Positive, False Negative 문제가 발생할 수 있다.\n\n\u003ctip\u003e\n  `False Positive`\n  실제로는 빈번하지 않은데 샘플링된 데이터에서는 빈번하다고 나온 경우\n  \u003cbr /\u003e\n  `False Negative`\n  실제로는 빈번한데 샘플링된 데이터에서는 빈번하지 않다고 나온 경우\n\u003c/tip\u003e\n\nFalse Positive의 경우에는 pass 2에서 빈번 집합의 경우 실제로 빈번하게 등장하는지 검사해 봄으로써 해결할 수 있다.\n하지만 False Negative의 경우에는 찾아낼 방법이 없다.\n\nthreshold를 더 작게 설정하는 방식으로 False Negative가 나올 확률을 줄일수는 있겠지만, 해결책은 아니다.\n\n---\n\n## SON Algorithm\n\n기본적인 방식은 랜덤 샘플링과 동일하다.\n차이점은 SON Algorithm음 모든 파일을 다 읽는다는 것이다.\n즉, 한 번 읽을 때 샘플링한 작은 청크를 읽지만, 이 과정을 여러번 반복해서 전체 파일을 읽어온다는 차이점이다.\n\n이 방식은 False Negative도 없다고 확신할 수 있다.\n왜냐하면 실제로 빈번한 집합이라면 읽어오는 모든 청크에 대해 최소 1개의 청크에서는 빈번하게 등장할 것이기 때문이다.\n\n하지만 모든 청크를 결국 메모리에 1번은 올려야 하기 때문에 시간이 오래 걸린다는 단점이 있다.\n\n---\n\n## Toivonen's Algorithm\n\n시작은 랜덤 샘플링과 같다.\n하지만 랜덤 샘플링에서 샘플을 파일의 1/100 수준으로 샘플링 한다면 threshold도 1/100 수준으로 설정할텐데 이 경우에는 좀 넉넉하게 1/125 정도로 설정한다는 차이가 있다.\n\n추가로 pass 1에서 Negative Border 라는 개념을 도입하여 False Negative를 방지한다.\n이 외에는 랜덤 샘플링 방식과 동일하다.\n\n### Negative Border\n\nNegative Border에 포함되는 집합은 본인은 빈번하지 않지만, 본인의 진 부분집합은 빈번하게 등장한 경우 포함된다.\n예시를 들어 알아보자.\n\n\u003e 모든 집합이 **\\{\\} \\{a\\} \\{b\\} \\{c\\} \\{a b\\} \\{b c\\} \\{a c\\} \\{a b c\\}** 만 존재한다고 가정해보자.\n\u003e\n\u003e `Case 1` **\\{a\\} \\{b\\}** 만 빈번하게 등장함 \u0026rarr; **\\{a b\\} \\{c\\}** 를 Negative Border로 추가.\n\u003e **\\{a b\\}** 의 경우에는 본인의 진 부분집합이 빈번하게 등장했으니 본인도 빈번하게 등장했을 가능성이 있다.\n\u003e 따라서 추가 검사를 진행해봐야 하는 것이다.\n\u003e **\\{c\\}** 의 경우에는 진 부분집합이랄게 없기 때문에 추가 검사를 진행해 봐야 하는 것이다.\n\u003e\n\u003e `Case 2` **\\{a\\} \\{b\\} \\{c\\}** 만 빈번하게 등장함 \u0026rarr; **\\{a b\\} \\{b c\\} \\{a c\\}** 를 Negative Border로 추가.\n\u003e 빈번하게 등장한 집합의 다음 스탭만 의심해야지, 나아가서 **\\{a b c\\}** 까지는 검사하지 않는다.\n\u003e\n\u003e `Case 3` **\\{\\}** (아무것도 빈번하지 않음) \u0026rarr; **\\{a\\} \\{b\\} \\{c\\}** 를 Negative Border로 추가.\n\u003e 샘플링을 너무 못했을 가능성이 높기에 일단 원소 1개짜리는 추가 검사를 해봐야 한다.\n\n이후 pass 2에서 빈번 항목 집합과 Negative Border에 대해 검사를 진행한다.\nFalse Positive의 경우에는 랜덤 샘플링과 마찬가지로 여기서 걸린다.\n\nFalse Negative의 경우에는 Negative Border에 포함된 집합을 검사하면서 나오게 될텐데,\n만약 Negative Border에 있는 집합이 실제로는 빈번하게 등장했다면 False Negative가 존재한다는 뜻이 된다.\n이런 경우에는 다른 샘플로 pass 1부터 다시 시도하게 된다.\n따라서 정확히는 2 pass안에 끝나지 않을 수는 있다.","slug":"univ_mmds/mid_03","readingMinutes":17,"wordCount":1340},{"title":"Spark 개념","description":"MapReduce 모델의 확장판, Spark에 대해 알아봅니다.","icon":"","image":"","tags":["Spark","RDD"],"draft":false,"date":"2023-10-19 / 15:04","content":"\n## MapReduce 문제점\n\n기존 MapReduce 모델의 문제점은 데이터 복제, Disk I/O 등의 오버헤드가 크다는 점이었다.\n\n하지만, ranks를 2개(map, reduce)로 나누어 관리하여 한 반향으로 데이터를 흐르게 만들어 \n시스템이 다운될 경우 재시작의 효율성이 올라가는 점도 고려하여 구현되었다.\n(단방향으로 흐르기에 처리 실패가 발생한 지점부터 다시 처리하면 됌)\n\n그러나, rank가 2개라 모든 문제를 map-reduce 패턴으로 묘사하기가 쉽지 않다는 점도 있었다.\n\n## Spark\n\n스파크는 오늘날 가장 많이 쓰이는 Data-Flow system으로 MapReduce에 비해 여러 부분에서 개선이 이루어졌다.\n\n1. rank를 2개로 제한하지 않음.\n  map, reduce 외의 tasks, ranks와 같은 여러 단계를 허용함.\n2. Map, Reduce 외의 별도의 유용한 함수 제공.\n3. 바로 디스크에 중간 결과를 저장하지 않고, 메모리에 캐싱하기도 함.\n  적당한 크기의 중간 결과는 메모리에 캐싱하기에 속도로 보다 빠르다\n4. MapReduce와 마찬가지로 단방향으로 데이터가 흐르는 DAGs 형식을 따른다.\n  (Directed Acycle Graphs)\n5. 여러 언어와 api를 제공하고, 오픈소스이며 호환성도 좋다.\n\n\u003ctip\u003e\n  `vs. Hadoop MapReduce`\n  Spark이 더 빠른대신 메모리 사용량도 더 많다.\n  Spark에서 제공하는 api가 더 많아 사용하기에 더 편하다.\n  둘 다 map-reduce 부분에서는 성능차이는 없다.\n\u003c/tip\u003e\n\n### RDD\n\nResilient Distributed Dataset의 약어로 Spark에서는 큰 데이터를 RDD 라는 청크로 쪼개어 key-value 페어로 저장한다.\n즉, RDD가 여러개의 클러스터에 분산 저장되는데, 가장 큰 특징은 RDD는 **읽기 전용**이라는 점이다.\n그렇기에 **파일로부터** RDD를 얻어오기도 하며, **RDD로부터** 새로운 RDD를 만드는 식으로 작업된다.\n또한, RDD는 일반적으로 **메모리에 캐싱**되며, 필요에 따라 디스크에 저장하기도 한다.\n\n\u003ctip\u003e\n  `DataFrame`\n  RDD와는 다르게 데이터들이 테이블 형태로 저장되먀 column별로 이름도 있다.\n  \u003cbr /\u003e\n  `DataSet`\n  DF의 상위호환으로 타입 세이프, 객체지향 프로그래밍 인터페이스를 지원하며, 컴파일 타임에 에러도 잡아낼 수 있다.\n\u003c/tip\u003e\n\n### Transformations\n\nRDD에서 새로운 RDD로의 변환을 Transformations라고 하는데, `map`, filter, join, union, intersection, distinct와 같은 변환이 있다.\n\n중요한 점은 이러한 변환은 `Lazy evaluation` 하게 동작한다는 점인데, 이게 무슨 말이냐면\n뭔가를 지시를 해도 실제로 수행을 하지 않는다는 뜻이다.\n지시를 하면 지시 사항을 기록하다가 사용자가 실제로 값을 요청시 기록된 요청을 최적화 알고리즘을 적용하여 한 번에 실행하기 때문에 효율적으로 동작하게 된다.\n\n### Actions\n\nLazy evaluation 중 실제로 동작을 수행하게 하는 명령이다.\ncount, collect, `reduce`, save 와 같은 명령이 있다.\n\n### Task Scheduler (General DAGs)\n\n![231019-153939](/posts/mid_02/231019-153939.png)\n\nSpark 스케쥴러는 스마트하게 동작하는데 그 특징은 다음과 같다.\n\n1. 파이프라인 함수를 제공한다.\n  Stage 1, Stage 2와 같이 여러 단계를 추상화하여 하나의 단계로 취급해 성능을 최적화 한다.\n2. 감당 가능한 크기의 데이터는 캐싱한다.\n  데이터를 캐싱하여 재사용성을 높이고, 속도도 빠르게 한다.\n3. key값 분포상태를 파악하여 불필요한 shuffle을 피한다.\n  일례로 A \u0026rarr; B로 넘어가며 키 값이 정렬되었으니, B \u0026rarr; F로 넘어갈때는 불필요한 셔플을 하지 않음.\n\n---\n\n## methods (real-code)\n\n\u003cnotice\u003e\n  Finding Similar Item까지 본 뒤에 코드를 보는 것이 더 좋습니다.\n\u003c/notice\u003e\n\n### (Spark) DataFrame\n\n- `printSchema()`\n  해당 데이터프레임의 스키마를 보여줍니다.\n\n- `take(N)`\n  N개의 행을 보여줍니다.\n\n- `show(n=N, truncate=boolean)`\n  N개의 행을 표 형태로 정리하여 보여줍니다.\n  truncate=False시 ...으로 요약되지 않은 전체 문자열을 출력합니다.\n\n- `select(columnName[])`\n  columnName에 해당하는 column들만 남긴 spark dataframe 객체를 반환합니다.\n\n- `selectExpr(sqlSelect[])`\n  sql select문에서 사용할 수 있는 문법을 이용하여 해당 column을 가져온 뒤 dataframe 객체로 반환합니다.\n\n- `sort(columnName, ascending=boolean)`\n  columnName을 기준으로 오름차순 정렬합니다.\n  ascending=False시 내림차순으로 정렬합니다.\n\n- `join(dataframe, this.column == dataframe.column)`\n  본인(this) dataframe과 인자로 넣은(dataframe) dataframe의 공통 column을 기준으로 natural join을 수행 후 dataframe 객체를 반환합니다.\n  단, 일반 sql과 다르게 공통 column이 하나만 표시되는게 아닌 중복되서 표시됩니다.\n\n- `toPandas()`\n  데이터가 pandas로 옮길 수 있을 만큼 작다면, spark dataframe에서 pandas dataframe으로 변환합니다.\n\n- `groupBy(columnName[])`\n  배열에 들어있는 모든 columnName을 기준으로 그루핑한 후 GroupedData 객체를 반환합니다.\n\n- `rdd`\n  spark dataframe에서 RDD 인스턴스를 생성합니다.\n\n### (spark) GroupedData\n\n- `count()`\n  각 그룹의 행의 개수를 카운트하여 count column을 만들고 dataframe 객체를 반환합니다.\n\n- `agg(column)`\n  column에 대해 집계함수를 수행합니다.\n  아래와 같이 응용하여 사용하면 item을 직렬화할 수 있습니다.\n  alias를 이용해 column의 이름을 변경할 수 있습니다.\n\n  ```python:.py\n  df = orders_joined.groupBy('order_id').agg(collect_set('product_name').alias('items'))\n  df.show()\n  ```\n\n  | order_id | items |\n  |---|---|\n  | 1 | [Bag of Organic B... ] |\n  | 96 | [Roasted Turkey, ... ] |\n  | 112 | [Umcka Elderberry... ] |\n\n### RDD (PipelinedRDD)\n\n- `collect()`\n  RDD를 출력합니다.\n\n- `map(function(row))`\n  RDD에 대해 function를 적용합니다.\n  파라미터로 RDD의 row가 전달됩니다.\n\n  ```python:.py\n  all_locations = jun_29_operations.rdd.map(lambda row: (row.TakeoffLocation, 1))\n  all_locations.take(3) \n  ```\n\n  적용 후 PipelinedRDD 객체를 반환합니다.\n\n  \u003e [('TAKHLI', 1), ('DANANG', 1), ('CONSTELLATION', 1)]\n\n- `flatMap(function)`\n  map과 동일한 기능을 수행합니다.\n  단, 결과가 1차원 배열만을 반환합니다.\n\n  ```python:.py\n  RDDs1 = RDDs1.flatMap(lambda line: line.split(' '))\n  ```\n\n- `reduceByKey(function(number, number))`\n  PipelinedRDD에 대해 function을 적용합니다.\n  파라미터로 2개의 key-value pair에 대해 value가 전달됩니다.\n\n  ```python:.py\n  locations_counts_rdd = all_locations.reduceByKey(lambda a, b: a+b).sortBy(lambda r: -r[1])\n  locations_counts_rdd.take(3)\n  ```\n\n  적용 후 PipelinedRDD 객체를 반환합니다.\n\n  \u003e [('CONSTELLATION', 87), ('TAKHLI', 56), ('KORAT', 55)]\n\n- `sortByKey(ascending=boolean)`\n  RDD key-value pair에 대해 key값을 기준으로 정렬합니다.\n\n- `filter(function)`\n  function이 true를 반환하는 값만 통과시켜 RDD객체를 반환합니다.\n\n### spark instance\n\n- `sql(queryString)`\n  sql문법을 queryString를 실행한 후 spark dataframe 객체를 반환합니다.\n\n- `createDataFrame(RDD)`\n  RDD를 spark dataframe 인스턴스로 변환합니다.\n  단, 인스턴스의 Row에 따라 Column의 이름이 결정됩니다.\n\n  예로 들어 reduceByKey 이후 바로 createDataFrame 생성시 Row의 이름이 작성되지 않아 Column명이 _1, _2와 같은 식으로 초기화됩니다.\n\n  따라서 아래의 코드로 이름을 지정하는 것이 시각화에 도움이 됩니다.\n\n  ```python:.py\n  locations_counts_with_schema = locations_counts_rdd.map(lambda r: Row(TakeoffLocation=r[0], MissionsCount=r[1]))\n  locations_counts = spark.createDataFrame(locations_counts_with_schema)\n  locations_counts.show()\n  ```\n\n- `sparkContext.textFile(path)`\n  path에 해당하는 파일을 읽은 뒤 RDD 인스턴스를 반환합니다.\n\n### FPGrowth\n\n- `FPGrowth(itemsCol=columnName, minSupport=number, minConfidence=number)`\n  dataframe의 columnName에 대해 연관규칙을 생성하는 FPGrowth 인스턴스를 생성합니다.\n  이 때 minSupport, minConfidence를 설정해야 합니다.\n\n- `fit(dataframe)`\n  생성된 FPGrowth 인스턴스에 대해 dataframe을 적용하여 FPGrowthModel을 만듭니다.\n\n- `freqItemsets, associationRules`\n  생성된 FPGrowthModel에 대해 `빈발 항목 집합`과 `연관 규칙`을 생성합니다.\n\n  ```python:.py\n  # grouping with order_id\n  df = orders_joined.groupBy('order_id').agg(collect_set('product_name').alias('items'))\n\n  # change to spark dataframe\n  df = spark.createDataFrame(df.toPandas(), ['id', 'items'])\n\n  # analysis using FP-Growth\n  from pyspark.ml.fpm import FPGrowth\n  fpGrowth = FPGrowth(itemsCol='items', minSupport=0.01, minConfidence=0.5)\n  model = fpGrowth.fit(df)\n\n  num_freqItemsets1 = model.freqItemsets.count()\n  num_associationRules1 = model.associationRules.count()\n  ```","slug":"univ_mmds/mid_02","readingMinutes":10,"wordCount":871},{"title":"분산 파일관리 시스템","description":"분산 파일관리 시스템에 관련한 기초 지식을 배웁니다.","icon":"","image":"","tags":["분산 파일관리","Chunk","Map","Reduce"],"draft":false,"date":"2023-10-19 / 14:13","content":"\n## 분산 파일관리 시스템\n\n방대한 데이터 보관, 또는 백업을 위해 데이터를 분산 저장하는 경우 여러대의 컴퓨터를 연결하여 하나처럼 동작하도록 구성해야 한다.\n\n하지만, 실시간으로 데이터를 처리해야 하는 부분에 대해서는 데이터를 복사하여 네트워크 전송을 통해 처리하는 방식은 네트워크 속도가 상대적으로 매우 느리기 때문에 문제가 있다.\n\n이런 경우에는 데이터를 옮기는 것이 아닌, 필요한 데이터를 보관하는 컴퓨터에게 `연산 작업을 맡기고`, `동기화는 주기적`으로 하는 방식을 사용하는 것이 좋다.\n\n이렇게 데이터를 분산하여 저장하는 시스템을 분산 파일관리 시스템이라 불리고, `Spark`, `MapReduce`와 같은 시스템이 이런 방식을 사용한다.\n하지만, 이런 파일관리 시스템은 1개의 머신만을 사용하는 시스템에 비해 속도가 느리기 때문에 아래의 조건을 만족하는 경우에만 사용하는 것이 바람직하다.\n\n1. 데이터 양이 매우 많은 경우\n2. 데이터의 수정은 왠만하면 일어나지 않는 경우\n3. 읽고 이어쓰기가 빈번하게 일어나는 경우\n\n### Chunk servers\n\n16~64MB 정도의 파일을 하나의 Chunk로 묶어 관리하는데, 이런 청크를 2, 3배 중복으로 다른 물리적 공간에 저장하는 식으로 분산 관리를 하게 되는데,\n이런 다른 물리적 공간을 Chunk server 라고 부른다.\n\n![231019-143146](/posts/mid_01/231019-143146.png)\n\n따라서 여러 청크서버에 동일한 청크가 분산 저장되어 있기 때문에 하나의 청크서버가 다운되더라도 데이터는 온전히 남는다.\n\n또한, 위에서 언급했 듯, 데이터를 움직이는 것이 아닌 연산을 일임한다고 했는데,\n서버의 과부화 방지를 위해 각 청크서버가 특정 청크에 필요한 연산을 전담하여 수행하고 결과를 반환한다.\n\n### Master node\n\n파일이 저장된 위치인 메타데이터를 저장한 서버이다.\n따라서 파일 엑세스 요청이 들어오면, 일단 모든 요청은 마스터 노드로 향하여 요청한 파일이 어느 청크서버에 있는지 알아낸다.\n이후 그 요청에 대한 응답은 청크서버로 직접 엑세스되어 청크서버에서 요청이 처리되게 된다.\n\n여기서 드는 의문점은 **왜 마스터 노드가 직접 데이터를 전달하지 않는가**이다.\n그 이유는 마스터 노드에 엑세스가 제일 많은데 데이터까지 전달하게 되면 과부화가 걸리기 때문에 그렇다.\n\n---\n\n## MapReduce\n\n초창기 분산 컴퓨팅 프로그래밍 모델이다.\n이 기술의 구현체로 Hadoop, Spark, Flink 등이 있는데, 이 모델의 동작 과정을 살펴보자.\n\n### overview\n\n![231019-144045](/posts/mid_01/231019-144045.png)\n\nMap, Group by Key(보통 자동으로 일어남), Reduce의 3단계로 이루어지는데, 각 단계에서 어떻게 일이 처리되는지 알아보자.\n\n참고로 Map, Reduce의 과정은 하나의 머신에서 일어나는 것이 아닌, 다중 머신에서 병렬적으로 일어난다는 점을 기억하자.\n\n### Map\n\n우선 개발자가 Map 함수를 작성한다.\nMap 함수는 읽은 데이터를 처리하기 위해 `key-value pair`로 변환하는 작업을 수행하게 된다.\n\n하지만 MapReduce에서 사용 가능한 규격으로 데이터를 처리해야 하는데 이 과정이 좀 까다로울 수 있다.\n\n추가로 이 이후에 생성된 key값을 이용해서 해싱같은 방식을 이용해 생성된 페어를 Reduce를 수행할 컴퓨터로 보내게 된다.\n\n### Group by Key\n\nMap으로 얻어진 pair을 key값을 중심으로 정렬하고, 중복된 key들에 대해 value 들을 배열로 묶어주는 일을 처리한다.\n대부분의 시스템에서 이 과정은 자동으로 일어나기 때문에 개발자가 개입할 부분이 상대적으로 적다.\n\n하지만 성능적으로 이 단계에서 `병목현상`이 발생할 수 있다.\nMap, Reduce는 파일이나 청크를 한 번만 탐색하면 끝나지만($O(n)$),\nGroup by Key는 정렬 및 그루핑을 해야하기 때문에 상대적으로 느리기 때문이다($O(n log(n))$).\n\n### Reduce\n\n개발자가 개발한 Reduce 함수를 이용해 배열로 되어있는 values들을 하나로 합쳐준다.\n이 과정이 종료되면 유니크한 key-value pairs가 생성될 것이다.\n\n### Dealing with Failures\n\n`Map worker`가 다운된 경우에는 일이 진행 중이든 완료되었든 간에 무조건 다른 worker에게 일을 처음부터 재시작하게 한다.\n왜냐하면 일이 완료된 경우 그 결과를 시간 비용의 문제 때문에 `로컬 디스크`에 데이터를 저장하기 때문이다.\n\n반면에 `Reduce worker`가 다운된 경우에는 일이 진행 중인 경우에만 다른 worker에게 일을 처음부터 재시작하도록 한다.\nReduce일이 완료된 경우, 그 결과는 중요한 데이터이니 `분산 저장`하기 때문에 완료된 경우에 다운되어도 재시작할 필요가 없는 것이다.\n\n### Cost Measure\n\nMapReduce 내부적으로 사용되는 알고리즘의 비용을 측정해보자.\n\n1. Communication cost\n  모든 프로세스의 **I/O bytes**\n\u003e (아래 항목을 모두 더하면 됌)\n\u003e - 입력 파일 사이즈\n\u003e - 2 $\\times$ Map process \u0026rarr; Reduce process 로 이동한 파일 사이즈 (2를 곱한 이유는 Map, Reduce 2개이기 때문)\n\u003e - Reduce process에서 나온 출력 사이즈의 합\n2. Elapsed communication cost\n  Communication cost 중 가장 큰(peak) 비용 (정확히는 파일 사이즈가 가장 큰 입력 파일 기준)\n  \u0026rarr; 이 비용이 작을수록 병렬(분산)화가 잘 되었다는 뜻이다.\n3. (Elapsed) Computation cost\n  1, 2와 동일, 단, 기준이 byte 단위가 아닌 **I/O 시간** 단위 기준임.\n\n\u003ctip\u003e\n  대부분의 클라우드 서비스는 Communication cost 기준으로 비용이 청구됌.\n  (Elapsed는 기준은 아님)\n\u003c/tip\u003e\n\n---\n\n## Problems Suited for MapReduce\n\nSpark과 같은 라이브러리 말고 MapReduce만 사용하기에도 충분한 문제들을 알아보자.\n보통 데이터 `순차탐색` 문제나, `비 실시간`으로 처리되어도 상관없는 여유로운 작업에 적합하다.\n\n### Host size\n\nurl로 부터 host를 추출하고, 해당 호스트에서 제공하는 많고 거대한 데이터의 총 크기(용량)을 알고싶을 때 사용할 수 있다.\n\n\u003e (host1, size1)\n\u003e (host2, size2)\n\u003e ...\n\n### Language Model\n\n언어 모델 개발시에도 이용할 수 있다.\n\n\u003e 5개의 단어 뭉치가 문서에서 얼마나 등장하는지\n\u003e (5-word seq, count)\n\n이런 경우도 map, reduce로 간단하게 만들 수 있다.\n\n### join\n\njoin 연산도 MapReduce로 할 수 있다.\n\n![231019-155529](/posts/mid_01/231019-155529.png)\n\n$R(A,B) \\Join S(B,C)$를 `natural join`한다로 해보자.\n\n\u003e `Map`\n\u003e 1. join에 사용될 column을 key로 사용하는 key-value 페어로 만든다.\n\u003e\n\u003e   ($b_1$, ($a_1$, R))\n\u003e   ($b_1$, ($a_2$, R))\n\u003e   ($b_2$, ($a_3$, R))\n\u003e   ($b_3$, ($a_4$, R))\n\u003e   ($b_2$, ($c_1$, S))\n\u003e   ($b_2$, ($c_2$, S))\n\u003e   ($b_3$, ($c_3$, S))\n\u003e\n\u003e 2. 키값을 해싱한 후 Reduce 프로세스로 보낸다.\n\n\u003e `Reduce`\n\u003e 1. Reduce를 진행한다.\n\u003e\n\u003e   ($h(b_1)$, [($a_1$, R), ($a_2$, R)])\n\u003e   ($h(b_2)$, [($a_3$, R), ($c_1$, S), ($c_2$, S)])\n\u003e   ($h(b_3)$, [($a_4$, R), ($c_3$, S)])\n\u003e\n\u003e 2. values에 R-S로 되어있는 value들만 묶어서 (a,b,c)로 출력한다.\n\u003e   (R-R, S-S를 제외하기 위해서 value pair에 R, S를 포함시킨 것이다)\n\u003e\n\u003e   ($a_3$, $b_2$, $c_1$)\n\u003e   ($a_3$, $b_2$, $c_2$)\n\u003e   ($a_4$, $b_3$, $c_3$)\n\n### Not Suited\n\n적합하지 않은 문제상황은 뭐가 있을까?\ngraph 탐색이나, ML에서의 `비 순차탐색` 하는 경우에는 적합치 않다.","slug":"univ_mmds/mid_01","readingMinutes":11,"wordCount":837},{"title":"대학 - 빅데이터 처리 및 응용","description":"3학년 2학기 빅데이터 처리 및 응용 수업 아카이브","icon":"","image":"","tags":[],"draft":false,"date":"2023-09-06 / 12:20","content":"","slug":"univ_mmds/index","readingMinutes":0,"wordCount":1}],"mdx":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    ol: \"ol\",\n    li: \"li\",\n    code: \"code\",\n    h2: \"h2\",\n    a: \"a\",\n    span: \"span\",\n    br: \"br\",\n    div: \"div\",\n    math: \"math\",\n    semantics: \"semantics\",\n    mrow: \"mrow\",\n    mi: \"mi\",\n    mo: \"mo\",\n    msub: \"msub\",\n    mn: \"mn\",\n    mfrac: \"mfrac\",\n    annotation: \"annotation\",\n    strong: \"strong\",\n    hr: \"hr\",\n    blockquote: \"blockquote\",\n    h3: \"h3\",\n    msup: \"msup\",\n    mtext: \"mtext\",\n    table: \"table\",\n    thead: \"thead\",\n    tr: \"tr\",\n    th: \"th\",\n    tbody: \"tbody\",\n    td: \"td\",\n    img: \"img\",\n    pre: \"pre\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"생김새가 비슷한 사이트를 묶거나, 표절 검사를 하거나, 비슷한 내용의 뉴스를 클러스터링 하는 등 여러 분야에서 사용될 수 있는 기술에 대해 설명합니다.\"\n    }), \"\\n\", _jsx(\"notice\", {\n      children: _jsx(_components.p, {\n        children: \"생김새가 비슷한 문서를 찾아내는 기술이지, 비슷한 토픽을 찾아내는 기술은 아닙니다.\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"아래의 단계를 거쳐 비슷한 문서를 찾게 되는데, 각 단계에 대한 세부적인 내용은 추후에 설명합니다.\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"Shingling\"\n        }), \"을 통해 데이터(문서)를 집합으로 변환\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"Minhashing\"\n        }), \"을 통해 큰 집합을 작은 시그니처로 변환\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.code, {\n          children: \"LSH\"\n        }), \"를 통해 시그니처를 분류 후 비슷한 집합 찾기\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h2, {\n      id: \"jaccard-similarity\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#jaccard-similarity\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Jaccard Similarity\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"세부내용 설명 전 개념 하나만 짚고 넘어가자.\", _jsx(_components.br, {}), \"\\n\", \"유사도를 검사할 때, 다음과 같은 경우를 고려해보자.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"A, B 모두 메이져한 게임들을 주로 플레이하고, A는 RPG를, B는 FPS를 주로 플레이한다고 가정하자.\", _jsx(_components.br, {}), \"\\n\", \"이 때, 마이너한 장르의 게임을 예시로 들며 유사도를 검사하는데, A, B 모두 해당 게임을 보유하지 않는다고 두 사람의 유사도가 높다고 이야기 할 수 있을까?\", _jsx(_components.br, {}), \"\\n\", \"두 사람은 그런 마이너한 장르의 게임에 관심이 없어서 갖고있지 않을 뿐인데, 둘 다 갖고있지 않다고 두 사람의 플레이스타일이 유사하다고 판단하는 것은 무리가 있다.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"따라서 이런 유사도 파악의 오류를 해결하기 위해 Jaccard 유사도를 사용하여 유사도를 측정하게 된다.\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"math math-display\",\n      children: _jsx(_components.span, {\n        className: \"katex-display\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              display: \"block\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mi, {\n                    children: \"S\"\n                  }), _jsx(_components.mi, {\n                    children: \"i\"\n                  }), _jsx(_components.mi, {\n                    children: \"m\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"C\"\n                    }), _jsx(_components.mn, {\n                      children: \"1\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    separator: \"true\",\n                    children: \",\"\n                  }), _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"C\"\n                    }), _jsx(_components.mn, {\n                      children: \"2\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsxs(_components.mfrac, {\n                    children: [_jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∣\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"C\"\n                        }), _jsx(_components.mn, {\n                          children: \"1\"\n                        })]\n                      }), _jsx(_components.mo, {\n                        children: \"∩\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"C\"\n                        }), _jsx(_components.mn, {\n                          children: \"2\"\n                        })]\n                      }), _jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∣\"\n                      })]\n                    }), _jsxs(_components.mrow, {\n                      children: [_jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∣\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"C\"\n                        }), _jsx(_components.mn, {\n                          children: \"1\"\n                        })]\n                      }), _jsx(_components.mo, {\n                        children: \"∪\"\n                      }), _jsxs(_components.msub, {\n                        children: [_jsx(_components.mi, {\n                          children: \"C\"\n                        }), _jsx(_components.mn, {\n                          children: \"2\"\n                        })]\n                      }), _jsx(_components.mi, {\n                        mathvariant: \"normal\",\n                        children: \"∣\"\n                      })]\n                    })]\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"Sim(C_1, C_2) = \\\\frac{|C_1 \\\\cap C_2|}{|C_1 \\\\cup C_2|}\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                style: {\n                  marginRight: \"0.05764em\"\n                },\n                children: \"S\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"im\"\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.07153em\"\n                  },\n                  children: \"C\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0715em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"1\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mpunct\",\n                children: \",\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.1667em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.07153em\"\n                  },\n                  children: \"C\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0715em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"2\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"2.363em\",\n                  verticalAlign: \"-0.936em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mopen nulldelimiter\"\n                }), _jsx(_components.span, {\n                  className: \"mfrac\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"1.427em\"\n                        },\n                        children: [_jsxs(_components.span, {\n                          style: {\n                            top: \"-2.314em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord\",\n                              children: \"∣\"\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal\",\n                                style: {\n                                  marginRight: \"0.07153em\"\n                                },\n                                children: \"C\"\n                              }), _jsx(_components.span, {\n                                className: \"msupsub\",\n                                children: _jsxs(_components.span, {\n                                  className: \"vlist-t vlist-t2\",\n                                  children: [_jsxs(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: [_jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.3011em\"\n                                      },\n                                      children: _jsxs(_components.span, {\n                                        style: {\n                                          top: \"-2.55em\",\n                                          marginLeft: \"-0.0715em\",\n                                          marginRight: \"0.05em\"\n                                        },\n                                        children: [_jsx(_components.span, {\n                                          className: \"pstrut\",\n                                          style: {\n                                            height: \"2.7em\"\n                                          }\n                                        }), _jsx(_components.span, {\n                                          className: \"sizing reset-size6 size3 mtight\",\n                                          children: _jsx(_components.span, {\n                                            className: \"mord mtight\",\n                                            children: \"1\"\n                                          })\n                                        })]\n                                      })\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-s\",\n                                      children: \"​\"\n                                    })]\n                                  }), _jsx(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.15em\"\n                                      },\n                                      children: _jsx(_components.span, {})\n                                    })\n                                  })]\n                                })\n                              })]\n                            }), _jsx(_components.span, {\n                              className: \"mspace\",\n                              style: {\n                                marginRight: \"0.2222em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"mbin\",\n                              children: \"∪\"\n                            }), _jsx(_components.span, {\n                              className: \"mspace\",\n                              style: {\n                                marginRight: \"0.2222em\"\n                              }\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal\",\n                                style: {\n                                  marginRight: \"0.07153em\"\n                                },\n                                children: \"C\"\n                              }), _jsx(_components.span, {\n                                className: \"msupsub\",\n                                children: _jsxs(_components.span, {\n                                  className: \"vlist-t vlist-t2\",\n                                  children: [_jsxs(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: [_jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.3011em\"\n                                      },\n                                      children: _jsxs(_components.span, {\n                                        style: {\n                                          top: \"-2.55em\",\n                                          marginLeft: \"-0.0715em\",\n                                          marginRight: \"0.05em\"\n                                        },\n                                        children: [_jsx(_components.span, {\n                                          className: \"pstrut\",\n                                          style: {\n                                            height: \"2.7em\"\n                                          }\n                                        }), _jsx(_components.span, {\n                                          className: \"sizing reset-size6 size3 mtight\",\n                                          children: _jsx(_components.span, {\n                                            className: \"mord mtight\",\n                                            children: \"2\"\n                                          })\n                                        })]\n                                      })\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-s\",\n                                      children: \"​\"\n                                    })]\n                                  }), _jsx(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.15em\"\n                                      },\n                                      children: _jsx(_components.span, {})\n                                    })\n                                  })]\n                                })\n                              })]\n                            }), _jsx(_components.span, {\n                              className: \"mord\",\n                              children: \"∣\"\n                            })]\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.23em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"frac-line\",\n                            style: {\n                              borderBottomWidth: \"0.04em\"\n                            }\n                          })]\n                        }), _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.677em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"3em\"\n                            }\n                          }), _jsxs(_components.span, {\n                            className: \"mord\",\n                            children: [_jsx(_components.span, {\n                              className: \"mord\",\n                              children: \"∣\"\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal\",\n                                style: {\n                                  marginRight: \"0.07153em\"\n                                },\n                                children: \"C\"\n                              }), _jsx(_components.span, {\n                                className: \"msupsub\",\n                                children: _jsxs(_components.span, {\n                                  className: \"vlist-t vlist-t2\",\n                                  children: [_jsxs(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: [_jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.3011em\"\n                                      },\n                                      children: _jsxs(_components.span, {\n                                        style: {\n                                          top: \"-2.55em\",\n                                          marginLeft: \"-0.0715em\",\n                                          marginRight: \"0.05em\"\n                                        },\n                                        children: [_jsx(_components.span, {\n                                          className: \"pstrut\",\n                                          style: {\n                                            height: \"2.7em\"\n                                          }\n                                        }), _jsx(_components.span, {\n                                          className: \"sizing reset-size6 size3 mtight\",\n                                          children: _jsx(_components.span, {\n                                            className: \"mord mtight\",\n                                            children: \"1\"\n                                          })\n                                        })]\n                                      })\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-s\",\n                                      children: \"​\"\n                                    })]\n                                  }), _jsx(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.15em\"\n                                      },\n                                      children: _jsx(_components.span, {})\n                                    })\n                                  })]\n                                })\n                              })]\n                            }), _jsx(_components.span, {\n                              className: \"mspace\",\n                              style: {\n                                marginRight: \"0.2222em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"mbin\",\n                              children: \"∩\"\n                            }), _jsx(_components.span, {\n                              className: \"mspace\",\n                              style: {\n                                marginRight: \"0.2222em\"\n                              }\n                            }), _jsxs(_components.span, {\n                              className: \"mord\",\n                              children: [_jsx(_components.span, {\n                                className: \"mord mathnormal\",\n                                style: {\n                                  marginRight: \"0.07153em\"\n                                },\n                                children: \"C\"\n                              }), _jsx(_components.span, {\n                                className: \"msupsub\",\n                                children: _jsxs(_components.span, {\n                                  className: \"vlist-t vlist-t2\",\n                                  children: [_jsxs(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: [_jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.3011em\"\n                                      },\n                                      children: _jsxs(_components.span, {\n                                        style: {\n                                          top: \"-2.55em\",\n                                          marginLeft: \"-0.0715em\",\n                                          marginRight: \"0.05em\"\n                                        },\n                                        children: [_jsx(_components.span, {\n                                          className: \"pstrut\",\n                                          style: {\n                                            height: \"2.7em\"\n                                          }\n                                        }), _jsx(_components.span, {\n                                          className: \"sizing reset-size6 size3 mtight\",\n                                          children: _jsx(_components.span, {\n                                            className: \"mord mtight\",\n                                            children: \"2\"\n                                          })\n                                        })]\n                                      })\n                                    }), _jsx(_components.span, {\n                                      className: \"vlist-s\",\n                                      children: \"​\"\n                                    })]\n                                  }), _jsx(_components.span, {\n                                    className: \"vlist-r\",\n                                    children: _jsx(_components.span, {\n                                      className: \"vlist\",\n                                      style: {\n                                        height: \"0.15em\"\n                                      },\n                                      children: _jsx(_components.span, {})\n                                    })\n                                  })]\n                                })\n                              })]\n                            }), _jsx(_components.span, {\n                              className: \"mord\",\n                              children: \"∣\"\n                            })]\n                          })]\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.936em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                }), _jsx(_components.span, {\n                  className: \"mclose nulldelimiter\"\n                })]\n              })]\n            })]\n          })]\n        })\n      })\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"즉, \", _jsx(_components.strong, {\n        children: \"두 사람 중 한 사람이라도 해당 게임을 보유하고 있는 경우에만 두 사람이 동시에 해당 게임을 보유하는가\"\n      }), \"로 유사도를 검사하는 것이다.\"]\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsxs(_components.h2, {\n      id: \"shingling\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#shingling\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Shingling\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"문서의 유사도를 측정할 때 그 기준이 되는 토큰을 생성하는 방법입니다.\", _jsx(_components.br, {}), \"\\n\", _jsx(_components.code, {\n        children: \"k-shingle\"\n      }), \" 과 같은 용어를 사용하는데, 이는 k개의 문자로 이루어진 shingle을 의미합니다.\", _jsx(_components.br, {}), \"\\n\", \"실제로 비슷한 문서를 싱글링 했을 때 집합의 원소도 일치하는 부분이 매우 많습니다.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"예로 들어 \\\"The dog which chased the cat\\\" 이라는 문장이 있다고 했을 때, 여기서 2-shingle를 구하면 다음과 같습니다.\"\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsx(_components.p, {\n        children: \"th(보통 소문자로 변환), he, e_, _d, do, og, ...\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"하지만, 2-shingle로 하면 th, he, do와 같이 문장으로 볼 때는 상당히 유니크한 의미를 갖는 문장이 이렇게 아무데서나 나올법한 shingle이 되어버립니다.\", _jsx(_components.br, {}), \"\\n\", \"따라서 보통은 \", _jsx(_components.code, {\n        children: \"8~10\"\n      }), \"-shingle로 하는 것이 적당합니다.\"]\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"tokens\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#tokens\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Tokens\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"10-shingle을 사용하는 경우에는 최대 \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsx(_components.mn, {\n                    children: \"2\"\n                  }), _jsxs(_components.msup, {\n                    children: [_jsx(_components.mn, {\n                      children: \"7\"\n                    }), _jsx(_components.mn, {\n                      children: \"10\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    children: \"≈\"\n                  }), _jsx(_components.mn, {\n                    children: \"200\"\n                  }), _jsx(_components.mtext, {\n                    children: \"조\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"27^{10} \\\\approx 200조\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8141em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"2\"\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord\",\n                  children: \"7\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsx(_components.span, {\n                    className: \"vlist-t\",\n                    children: _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.8141em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-3.063em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"10\"\n                              })\n                            })\n                          })]\n                        })\n                      })\n                    })\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"≈\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.6833em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"200\"\n              }), _jsx(_components.span, {\n                className: \"mord hangul_fallback\",\n                children: \"조\"\n              })]\n            })]\n          })]\n        })\n      }), \" 개의 싱글이 생성되게 됩니다.\", _jsx(_components.br, {}), \"\\n\", \"이를 메모리상에서 관리하는 것은 현실적으로 불가능한 일입니다.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"따라서 싱글을 해싱하여 4bytes의 자료형으로 변환하여 \", _jsx(_components.code, {\n        children: \"Token\"\n      }), \"으로서 사용하게 됩니다.\", _jsx(_components.br, {}), \"\\n\", \"4bytes로 최대 약 42억개의 서로 다른 싱글을 표현할 수 있습니다.\", _jsx(_components.br, {}), \"\\n\", \"물론 다른 싱글에 대해 같은 토큰이 생성될 수 있지만, 그리 빈번한 경우는 아닐 것이며, 효율상 이 방법이 더 좋습니다.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"즉, 같은 토큰을 보유한 문서가 있다면, 그 문서들은 같은 싱글을 갖고있다는 얘기이므로, 유사도가 있다고 판단할 수 있겠습니다.\"\n    }), \"\\n\", _jsx(_components.hr, {}), \"\\n\", _jsxs(_components.h2, {\n      id: \"minhashing\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#minhashing\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Minhashing\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Minhashing을 알아보기 전, 데이터를 표현하는 행렬을 읽는 법을 알고가자.\"\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"(token)\"\n          }), _jsx(_components.th, {\n            children: _jsx(_components.span, {\n              className: \"math math-inline\",\n              children: _jsxs(_components.span, {\n                className: \"katex\",\n                children: [_jsx(_components.span, {\n                  className: \"katex-mathml\",\n                  children: _jsx(_components.math, {\n                    xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                    children: _jsxs(_components.semantics, {\n                      children: [_jsx(_components.mrow, {\n                        children: _jsxs(_components.msub, {\n                          children: [_jsx(_components.mi, {\n                            children: \"C\"\n                          }), _jsx(_components.mn, {\n                            children: \"1\"\n                          })]\n                        })\n                      }), _jsx(_components.annotation, {\n                        encoding: \"application/x-tex\",\n                        children: \"C_1\"\n                      })]\n                    })\n                  })\n                }), _jsx(_components.span, {\n                  className: \"katex-html\",\n                  \"aria-hidden\": \"true\",\n                  children: _jsxs(_components.span, {\n                    className: \"base\",\n                    children: [_jsx(_components.span, {\n                      className: \"strut\",\n                      style: {\n                        height: \"0.8333em\",\n                        verticalAlign: \"-0.15em\"\n                      }\n                    }), _jsxs(_components.span, {\n                      className: \"mord\",\n                      children: [_jsx(_components.span, {\n                        className: \"mord mathnormal\",\n                        style: {\n                          marginRight: \"0.07153em\"\n                        },\n                        children: \"C\"\n                      }), _jsx(_components.span, {\n                        className: \"msupsub\",\n                        children: _jsxs(_components.span, {\n                          className: \"vlist-t vlist-t2\",\n                          children: [_jsxs(_components.span, {\n                            className: \"vlist-r\",\n                            children: [_jsx(_components.span, {\n                              className: \"vlist\",\n                              style: {\n                                height: \"0.3011em\"\n                              },\n                              children: _jsxs(_components.span, {\n                                style: {\n                                  top: \"-2.55em\",\n                                  marginLeft: \"-0.0715em\",\n                                  marginRight: \"0.05em\"\n                                },\n                                children: [_jsx(_components.span, {\n                                  className: \"pstrut\",\n                                  style: {\n                                    height: \"2.7em\"\n                                  }\n                                }), _jsx(_components.span, {\n                                  className: \"sizing reset-size6 size3 mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"1\"\n                                  })\n                                })]\n                              })\n                            }), _jsx(_components.span, {\n                              className: \"vlist-s\",\n                              children: \"​\"\n                            })]\n                          }), _jsx(_components.span, {\n                            className: \"vlist-r\",\n                            children: _jsx(_components.span, {\n                              className: \"vlist\",\n                              style: {\n                                height: \"0.15em\"\n                              },\n                              children: _jsx(_components.span, {})\n                            })\n                          })]\n                        })\n                      })]\n                    })]\n                  })\n                })]\n              })\n            })\n          }), _jsx(_components.th, {\n            children: _jsx(_components.span, {\n              className: \"math math-inline\",\n              children: _jsxs(_components.span, {\n                className: \"katex\",\n                children: [_jsx(_components.span, {\n                  className: \"katex-mathml\",\n                  children: _jsx(_components.math, {\n                    xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                    children: _jsxs(_components.semantics, {\n                      children: [_jsx(_components.mrow, {\n                        children: _jsxs(_components.msub, {\n                          children: [_jsx(_components.mi, {\n                            children: \"C\"\n                          }), _jsx(_components.mn, {\n                            children: \"2\"\n                          })]\n                        })\n                      }), _jsx(_components.annotation, {\n                        encoding: \"application/x-tex\",\n                        children: \"C_2\"\n                      })]\n                    })\n                  })\n                }), _jsx(_components.span, {\n                  className: \"katex-html\",\n                  \"aria-hidden\": \"true\",\n                  children: _jsxs(_components.span, {\n                    className: \"base\",\n                    children: [_jsx(_components.span, {\n                      className: \"strut\",\n                      style: {\n                        height: \"0.8333em\",\n                        verticalAlign: \"-0.15em\"\n                      }\n                    }), _jsxs(_components.span, {\n                      className: \"mord\",\n                      children: [_jsx(_components.span, {\n                        className: \"mord mathnormal\",\n                        style: {\n                          marginRight: \"0.07153em\"\n                        },\n                        children: \"C\"\n                      }), _jsx(_components.span, {\n                        className: \"msupsub\",\n                        children: _jsxs(_components.span, {\n                          className: \"vlist-t vlist-t2\",\n                          children: [_jsxs(_components.span, {\n                            className: \"vlist-r\",\n                            children: [_jsx(_components.span, {\n                              className: \"vlist\",\n                              style: {\n                                height: \"0.3011em\"\n                              },\n                              children: _jsxs(_components.span, {\n                                style: {\n                                  top: \"-2.55em\",\n                                  marginLeft: \"-0.0715em\",\n                                  marginRight: \"0.05em\"\n                                },\n                                children: [_jsx(_components.span, {\n                                  className: \"pstrut\",\n                                  style: {\n                                    height: \"2.7em\"\n                                  }\n                                }), _jsx(_components.span, {\n                                  className: \"sizing reset-size6 size3 mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"2\"\n                                  })\n                                })]\n                              })\n                            }), _jsx(_components.span, {\n                              className: \"vlist-s\",\n                              children: \"​\"\n                            })]\n                          }), _jsx(_components.span, {\n                            className: \"vlist-r\",\n                            children: _jsx(_components.span, {\n                              className: \"vlist\",\n                              style: {\n                                height: \"0.15em\"\n                              },\n                              children: _jsx(_components.span, {})\n                            })\n                          })]\n                        })\n                      })]\n                    })]\n                  })\n                })]\n              })\n            })\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"a\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"b\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"c\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"d\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"a 토큰(싱글)은 문서(Column) 1, 2에서 모두 없다는 뜻이고, b는 문서 1에서만 갖고있다는 뜻으로 해석하면 된다.\", _jsx(_components.br, {}), \"\\n\", \"참고로 위의 경우 두 문서의 Jaccard 유사도는 \", _jsx(_components.strong, {\n        children: \"1/3\"\n      }), \"이다. (a는 둘 다 없기에 비교대상이 아니다)\"]\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"permute-the-rows\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#permute-the-rows\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Permute the rows\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"우선 행을 핸덤으로 뒤죽박죽 섞는다.\", _jsx(_components.br, {}), \"\\n\", \"섞는다는 것은 실제로 맊 섞는다는 것이 아닌, 탐색 순서를 섞는다는 것을 의미하는데, 구현 관점에서 해싱을 돌리는 것과 같다.\", _jsx(_components.br, {}), \"\\n\", \"예시를 보며 이해해보자.\"]\n    }), \"\\n\", _jsxs(_components.table, {\n      children: [_jsx(_components.thead, {\n        children: _jsxs(_components.tr, {\n          children: [_jsx(_components.th, {\n            children: \"(row)\"\n          }), _jsx(_components.th, {\n            children: _jsx(_components.span, {\n              className: \"math math-inline\",\n              children: _jsxs(_components.span, {\n                className: \"katex\",\n                children: [_jsx(_components.span, {\n                  className: \"katex-mathml\",\n                  children: _jsx(_components.math, {\n                    xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                    children: _jsxs(_components.semantics, {\n                      children: [_jsx(_components.mrow, {\n                        children: _jsxs(_components.msub, {\n                          children: [_jsx(_components.mi, {\n                            children: \"C\"\n                          }), _jsx(_components.mn, {\n                            children: \"1\"\n                          })]\n                        })\n                      }), _jsx(_components.annotation, {\n                        encoding: \"application/x-tex\",\n                        children: \"C_1\"\n                      })]\n                    })\n                  })\n                }), _jsx(_components.span, {\n                  className: \"katex-html\",\n                  \"aria-hidden\": \"true\",\n                  children: _jsxs(_components.span, {\n                    className: \"base\",\n                    children: [_jsx(_components.span, {\n                      className: \"strut\",\n                      style: {\n                        height: \"0.8333em\",\n                        verticalAlign: \"-0.15em\"\n                      }\n                    }), _jsxs(_components.span, {\n                      className: \"mord\",\n                      children: [_jsx(_components.span, {\n                        className: \"mord mathnormal\",\n                        style: {\n                          marginRight: \"0.07153em\"\n                        },\n                        children: \"C\"\n                      }), _jsx(_components.span, {\n                        className: \"msupsub\",\n                        children: _jsxs(_components.span, {\n                          className: \"vlist-t vlist-t2\",\n                          children: [_jsxs(_components.span, {\n                            className: \"vlist-r\",\n                            children: [_jsx(_components.span, {\n                              className: \"vlist\",\n                              style: {\n                                height: \"0.3011em\"\n                              },\n                              children: _jsxs(_components.span, {\n                                style: {\n                                  top: \"-2.55em\",\n                                  marginLeft: \"-0.0715em\",\n                                  marginRight: \"0.05em\"\n                                },\n                                children: [_jsx(_components.span, {\n                                  className: \"pstrut\",\n                                  style: {\n                                    height: \"2.7em\"\n                                  }\n                                }), _jsx(_components.span, {\n                                  className: \"sizing reset-size6 size3 mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"1\"\n                                  })\n                                })]\n                              })\n                            }), _jsx(_components.span, {\n                              className: \"vlist-s\",\n                              children: \"​\"\n                            })]\n                          }), _jsx(_components.span, {\n                            className: \"vlist-r\",\n                            children: _jsx(_components.span, {\n                              className: \"vlist\",\n                              style: {\n                                height: \"0.15em\"\n                              },\n                              children: _jsx(_components.span, {})\n                            })\n                          })]\n                        })\n                      })]\n                    })]\n                  })\n                })]\n              })\n            })\n          }), _jsx(_components.th, {\n            children: _jsx(_components.span, {\n              className: \"math math-inline\",\n              children: _jsxs(_components.span, {\n                className: \"katex\",\n                children: [_jsx(_components.span, {\n                  className: \"katex-mathml\",\n                  children: _jsx(_components.math, {\n                    xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                    children: _jsxs(_components.semantics, {\n                      children: [_jsx(_components.mrow, {\n                        children: _jsxs(_components.msub, {\n                          children: [_jsx(_components.mi, {\n                            children: \"C\"\n                          }), _jsx(_components.mn, {\n                            children: \"2\"\n                          })]\n                        })\n                      }), _jsx(_components.annotation, {\n                        encoding: \"application/x-tex\",\n                        children: \"C_2\"\n                      })]\n                    })\n                  })\n                }), _jsx(_components.span, {\n                  className: \"katex-html\",\n                  \"aria-hidden\": \"true\",\n                  children: _jsxs(_components.span, {\n                    className: \"base\",\n                    children: [_jsx(_components.span, {\n                      className: \"strut\",\n                      style: {\n                        height: \"0.8333em\",\n                        verticalAlign: \"-0.15em\"\n                      }\n                    }), _jsxs(_components.span, {\n                      className: \"mord\",\n                      children: [_jsx(_components.span, {\n                        className: \"mord mathnormal\",\n                        style: {\n                          marginRight: \"0.07153em\"\n                        },\n                        children: \"C\"\n                      }), _jsx(_components.span, {\n                        className: \"msupsub\",\n                        children: _jsxs(_components.span, {\n                          className: \"vlist-t vlist-t2\",\n                          children: [_jsxs(_components.span, {\n                            className: \"vlist-r\",\n                            children: [_jsx(_components.span, {\n                              className: \"vlist\",\n                              style: {\n                                height: \"0.3011em\"\n                              },\n                              children: _jsxs(_components.span, {\n                                style: {\n                                  top: \"-2.55em\",\n                                  marginLeft: \"-0.0715em\",\n                                  marginRight: \"0.05em\"\n                                },\n                                children: [_jsx(_components.span, {\n                                  className: \"pstrut\",\n                                  style: {\n                                    height: \"2.7em\"\n                                  }\n                                }), _jsx(_components.span, {\n                                  className: \"sizing reset-size6 size3 mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"2\"\n                                  })\n                                })]\n                              })\n                            }), _jsx(_components.span, {\n                              className: \"vlist-s\",\n                              children: \"​\"\n                            })]\n                          }), _jsx(_components.span, {\n                            className: \"vlist-r\",\n                            children: _jsx(_components.span, {\n                              className: \"vlist\",\n                              style: {\n                                height: \"0.15em\"\n                              },\n                              children: _jsx(_components.span, {})\n                            })\n                          })]\n                        })\n                      })]\n                    })]\n                  })\n                })]\n              })\n            })\n          }), _jsx(_components.th, {\n            children: _jsx(_components.span, {\n              className: \"math math-inline\",\n              children: _jsxs(_components.span, {\n                className: \"katex\",\n                children: [_jsx(_components.span, {\n                  className: \"katex-mathml\",\n                  children: _jsx(_components.math, {\n                    xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                    children: _jsxs(_components.semantics, {\n                      children: [_jsx(_components.mrow, {\n                        children: _jsxs(_components.msub, {\n                          children: [_jsx(_components.mi, {\n                            children: \"C\"\n                          }), _jsx(_components.mn, {\n                            children: \"3\"\n                          })]\n                        })\n                      }), _jsx(_components.annotation, {\n                        encoding: \"application/x-tex\",\n                        children: \"C_3\"\n                      })]\n                    })\n                  })\n                }), _jsx(_components.span, {\n                  className: \"katex-html\",\n                  \"aria-hidden\": \"true\",\n                  children: _jsxs(_components.span, {\n                    className: \"base\",\n                    children: [_jsx(_components.span, {\n                      className: \"strut\",\n                      style: {\n                        height: \"0.8333em\",\n                        verticalAlign: \"-0.15em\"\n                      }\n                    }), _jsxs(_components.span, {\n                      className: \"mord\",\n                      children: [_jsx(_components.span, {\n                        className: \"mord mathnormal\",\n                        style: {\n                          marginRight: \"0.07153em\"\n                        },\n                        children: \"C\"\n                      }), _jsx(_components.span, {\n                        className: \"msupsub\",\n                        children: _jsxs(_components.span, {\n                          className: \"vlist-t vlist-t2\",\n                          children: [_jsxs(_components.span, {\n                            className: \"vlist-r\",\n                            children: [_jsx(_components.span, {\n                              className: \"vlist\",\n                              style: {\n                                height: \"0.3011em\"\n                              },\n                              children: _jsxs(_components.span, {\n                                style: {\n                                  top: \"-2.55em\",\n                                  marginLeft: \"-0.0715em\",\n                                  marginRight: \"0.05em\"\n                                },\n                                children: [_jsx(_components.span, {\n                                  className: \"pstrut\",\n                                  style: {\n                                    height: \"2.7em\"\n                                  }\n                                }), _jsx(_components.span, {\n                                  className: \"sizing reset-size6 size3 mtight\",\n                                  children: _jsx(_components.span, {\n                                    className: \"mord mtight\",\n                                    children: \"3\"\n                                  })\n                                })]\n                              })\n                            }), _jsx(_components.span, {\n                              className: \"vlist-s\",\n                              children: \"​\"\n                            })]\n                          }), _jsx(_components.span, {\n                            className: \"vlist-r\",\n                            children: _jsx(_components.span, {\n                              className: \"vlist\",\n                              style: {\n                                height: \"0.15em\"\n                              },\n                              children: _jsx(_components.span, {})\n                            })\n                          })]\n                        })\n                      })]\n                    })]\n                  })\n                })]\n              })\n            })\n          })]\n        })\n      }), _jsxs(_components.tbody, {\n        children: [_jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"2\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"3\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"4\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          })]\n        }), _jsxs(_components.tr, {\n          children: [_jsx(_components.td, {\n            children: \"5\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          }), _jsx(_components.td, {\n            children: \"0\"\n          }), _jsx(_components.td, {\n            children: \"1\"\n          })]\n        })]\n      })]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"h\"\n                    }), _jsx(_components.mn, {\n                      children: \"1\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mi, {\n                    mathvariant: \"normal\",\n                    children: \"%\"\n                  }), _jsx(_components.mn, {\n                    children: \"5\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"h_1(x) = x \\\\% 5\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"h\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"1\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8056em\",\n                  verticalAlign: \"-0.0556em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"%5\"\n              })]\n            })]\n          })]\n        })\n      }), \" 해시함수를 적용하면 탐색 순서는 다음과 같아진다.\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.strong, {\n          children: \"5\"\n        }), \"(0) → \", _jsx(_components.strong, {\n          children: \"1\"\n        }), \"(1) → \", _jsx(_components.strong, {\n          children: \"2\"\n        }), \"(2) → \", _jsx(_components.strong, {\n          children: \"3\"\n        }), \"(3) → \", _jsx(_components.strong, {\n          children: \"4\"\n        }), \"(4)\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [_jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsxs(_components.mrow, {\n                  children: [_jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"h\"\n                    }), _jsx(_components.mn, {\n                      children: \"2\"\n                    })]\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mo, {\n                    children: \"=\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \"(\"\n                  }), _jsx(_components.mn, {\n                    children: \"2\"\n                  }), _jsx(_components.mi, {\n                    children: \"x\"\n                  }), _jsx(_components.mo, {\n                    children: \"+\"\n                  }), _jsx(_components.mn, {\n                    children: \"1\"\n                  }), _jsx(_components.mo, {\n                    stretchy: \"false\",\n                    children: \")\"\n                  }), _jsx(_components.mi, {\n                    mathvariant: \"normal\",\n                    children: \"%\"\n                  }), _jsx(_components.mn, {\n                    children: \"5\"\n                  })]\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"h_2(x) = (2x+1) \\\\% 5\"\n                })]\n              })\n            })\n          }), _jsxs(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: [_jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  children: \"h\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"0em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"2\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mrel\",\n                children: \"=\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2778em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mopen\",\n                children: \"(\"\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"2\"\n              }), _jsx(_components.span, {\n                className: \"mord mathnormal\",\n                children: \"x\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mbin\",\n                children: \"+\"\n              }), _jsx(_components.span, {\n                className: \"mspace\",\n                style: {\n                  marginRight: \"0.2222em\"\n                }\n              })]\n            }), _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"1em\",\n                  verticalAlign: \"-0.25em\"\n                }\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"1\"\n              }), _jsx(_components.span, {\n                className: \"mclose\",\n                children: \")\"\n              }), _jsx(_components.span, {\n                className: \"mord\",\n                children: \"%5\"\n              })]\n            })]\n          })]\n        })\n      }), \" 해시함수를 적용하면 탐색 순서는 다음과 같아진다.\"]\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.strong, {\n          children: \"2\"\n        }), \"(0) → \", _jsx(_components.strong, {\n          children: \"5\"\n        }), \"(1) → \", _jsx(_components.strong, {\n          children: \"3\"\n        }), \"(2) → \", _jsx(_components.strong, {\n          children: \"1\"\n        }), \"(3) → \", _jsx(_components.strong, {\n          children: \"4\"\n        }), \"(4)\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"create-signature\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#create-signature\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"Create signature\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"탐색 순서에 맞게 처음으로 1(토큰 보유)을 만나는 탐색 순서를 기록한다.\"\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.span, {\n          className: \"math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"h\"\n                      }), _jsx(_components.mn, {\n                        children: \"1\"\n                      })]\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"h_1\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.8444em\",\n                    verticalAlign: \"-0.15em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"h\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3011em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"1\"\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.15em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                })]\n              })\n            })]\n          })\n        }), \"를 적용한 탐색시 생성되는 Singature matrix\", _jsx(_components.br, {}), \"\\n\", \"[1, 2, 1]\"]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.span, {\n          className: \"math math-inline\",\n          children: _jsxs(_components.span, {\n            className: \"katex\",\n            children: [_jsx(_components.span, {\n              className: \"katex-mathml\",\n              children: _jsx(_components.math, {\n                xmlns: \"http://www.w3.org/1998/Math/MathML\",\n                children: _jsxs(_components.semantics, {\n                  children: [_jsx(_components.mrow, {\n                    children: _jsxs(_components.msub, {\n                      children: [_jsx(_components.mi, {\n                        children: \"h\"\n                      }), _jsx(_components.mn, {\n                        children: \"2\"\n                      })]\n                    })\n                  }), _jsx(_components.annotation, {\n                    encoding: \"application/x-tex\",\n                    children: \"h_2\"\n                  })]\n                })\n              })\n            }), _jsx(_components.span, {\n              className: \"katex-html\",\n              \"aria-hidden\": \"true\",\n              children: _jsxs(_components.span, {\n                className: \"base\",\n                children: [_jsx(_components.span, {\n                  className: \"strut\",\n                  style: {\n                    height: \"0.8444em\",\n                    verticalAlign: \"-0.15em\"\n                  }\n                }), _jsxs(_components.span, {\n                  className: \"mord\",\n                  children: [_jsx(_components.span, {\n                    className: \"mord mathnormal\",\n                    children: \"h\"\n                  }), _jsx(_components.span, {\n                    className: \"msupsub\",\n                    children: _jsxs(_components.span, {\n                      className: \"vlist-t vlist-t2\",\n                      children: [_jsxs(_components.span, {\n                        className: \"vlist-r\",\n                        children: [_jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.3011em\"\n                          },\n                          children: _jsxs(_components.span, {\n                            style: {\n                              top: \"-2.55em\",\n                              marginLeft: \"0em\",\n                              marginRight: \"0.05em\"\n                            },\n                            children: [_jsx(_components.span, {\n                              className: \"pstrut\",\n                              style: {\n                                height: \"2.7em\"\n                              }\n                            }), _jsx(_components.span, {\n                              className: \"sizing reset-size6 size3 mtight\",\n                              children: _jsx(_components.span, {\n                                className: \"mord mtight\",\n                                children: \"2\"\n                              })\n                            })]\n                          })\n                        }), _jsx(_components.span, {\n                          className: \"vlist-s\",\n                          children: \"​\"\n                        })]\n                      }), _jsx(_components.span, {\n                        className: \"vlist-r\",\n                        children: _jsx(_components.span, {\n                          className: \"vlist\",\n                          style: {\n                            height: \"0.15em\"\n                          },\n                          children: _jsx(_components.span, {})\n                        })\n                      })]\n                    })\n                  })]\n                })]\n              })\n            })]\n          })\n        }), \"를 적용한 탐색시 생성되는 Singature matrix\", _jsx(_components.br, {}), \"\\n\", \"[1, 3, 1]\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"즉, \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"C\"\n                    }), _jsx(_components.mn, {\n                      children: \"1\"\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"C_1\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8333em\",\n                  verticalAlign: \"-0.15em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.07153em\"\n                  },\n                  children: \"C\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0715em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"1\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \"에 대한 시그니처는 11, \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"C\"\n                    }), _jsx(_components.mn, {\n                      children: \"2\"\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"C_2\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8333em\",\n                  verticalAlign: \"-0.15em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.07153em\"\n                  },\n                  children: \"C\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0715em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"2\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \"는 23, \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"C\"\n                    }), _jsx(_components.mn, {\n                      children: \"3\"\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"C_3\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8333em\",\n                  verticalAlign: \"-0.15em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.07153em\"\n                  },\n                  children: \"C\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0715em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"3\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \"은 11이 된다.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"여기서 중요한 특징이 있는데, 시그니처의 길이가 길어질 수록(무작위 순서에 의한 탐색 횟수가 늘어날 수록) 시그니처가 일치할 확률이 Jaccard 유사도와 확률이 같아진다.\", _jsx(_components.br, {}), \"\\n\", \"그 이유를 간단한 예시로 이해해보자.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"우선, \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"C\"\n                    }), _jsx(_components.mn, {\n                      children: \"2\"\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"C_2\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8333em\",\n                  verticalAlign: \"-0.15em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.07153em\"\n                  },\n                  children: \"C\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0715em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"2\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \"과 \", _jsx(_components.span, {\n        className: \"math math-inline\",\n        children: _jsxs(_components.span, {\n          className: \"katex\",\n          children: [_jsx(_components.span, {\n            className: \"katex-mathml\",\n            children: _jsx(_components.math, {\n              xmlns: \"http://www.w3.org/1998/Math/MathML\",\n              children: _jsxs(_components.semantics, {\n                children: [_jsx(_components.mrow, {\n                  children: _jsxs(_components.msub, {\n                    children: [_jsx(_components.mi, {\n                      children: \"C\"\n                    }), _jsx(_components.mn, {\n                      children: \"3\"\n                    })]\n                  })\n                }), _jsx(_components.annotation, {\n                  encoding: \"application/x-tex\",\n                  children: \"C_3\"\n                })]\n              })\n            })\n          }), _jsx(_components.span, {\n            className: \"katex-html\",\n            \"aria-hidden\": \"true\",\n            children: _jsxs(_components.span, {\n              className: \"base\",\n              children: [_jsx(_components.span, {\n                className: \"strut\",\n                style: {\n                  height: \"0.8333em\",\n                  verticalAlign: \"-0.15em\"\n                }\n              }), _jsxs(_components.span, {\n                className: \"mord\",\n                children: [_jsx(_components.span, {\n                  className: \"mord mathnormal\",\n                  style: {\n                    marginRight: \"0.07153em\"\n                  },\n                  children: \"C\"\n                }), _jsx(_components.span, {\n                  className: \"msupsub\",\n                  children: _jsxs(_components.span, {\n                    className: \"vlist-t vlist-t2\",\n                    children: [_jsxs(_components.span, {\n                      className: \"vlist-r\",\n                      children: [_jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.3011em\"\n                        },\n                        children: _jsxs(_components.span, {\n                          style: {\n                            top: \"-2.55em\",\n                            marginLeft: \"-0.0715em\",\n                            marginRight: \"0.05em\"\n                          },\n                          children: [_jsx(_components.span, {\n                            className: \"pstrut\",\n                            style: {\n                              height: \"2.7em\"\n                            }\n                          }), _jsx(_components.span, {\n                            className: \"sizing reset-size6 size3 mtight\",\n                            children: _jsx(_components.span, {\n                              className: \"mord mtight\",\n                              children: \"3\"\n                            })\n                          })]\n                        })\n                      }), _jsx(_components.span, {\n                        className: \"vlist-s\",\n                        children: \"​\"\n                      })]\n                    }), _jsx(_components.span, {\n                      className: \"vlist-r\",\n                      children: _jsx(_components.span, {\n                        className: \"vlist\",\n                        style: {\n                          height: \"0.15em\"\n                        },\n                        children: _jsx(_components.span, {})\n                      })\n                    })]\n                  })\n                })]\n              })]\n            })\n          })]\n        })\n      }), \"의 Jaccard 유사도는 \", _jsx(_components.strong, {\n        children: \"1/4\"\n      }), \"이다.\", _jsx(_components.br, {}), \"\\n\", \"그런데 이 때, Singature가 같아지는 경우는 무엇일까? 바로 \", _jsx(_components.strong, {\n        children: \"최초로 1이 나오는 시점이 같다\"\n      }), \"는 이야기이다.\", _jsx(_components.br, {}), \"\\n\", \"즉, 같은 row에 대해 둘 다 1이 들어가 있는 row를 고를 확률과 같아진다.\", _jsx(_components.br, {}), \"\\n\", \"둘 다 0인 경우를 제외하면 4개 중에 둘 다 1인 row는 1개 존재하기에 Jaccard 유사도와 동일한 \", _jsx(_components.strong, {\n        children: \"1/4\"\n      }), \" 확률을 갖는다.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/posts/mid_05/231020-235719.png\",\n        alt: \"231020-235719\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"이해를 돕기 위해 다른 예시도 보자.\"\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"원래대로라면 생성되는 모든 토큰(42억개)에 대해 유사도를 검사 했어야 했다.\", _jsx(_components.br, {}), \"\\n\", \"하지만, 시그니처를 만드는 과정에서 무작위 순서로 탐색을 진핼할 때, 탐색개수를 제한을 걸면 검사 시간을 줄일 수 있다.\", _jsx(_components.br, {}), \"\\n\", \"예로 들어 해시함수의 결과를 50까지만 검색한다면 42억개의 항목에 대해 검사를 진행하지 않아도 된다.\"]\n    }), \"\\n\", _jsxs(_components.p, {\n      children: [\"이 때 검사 개수를 줄인 만큼 서로다른 해시를 여러 번 진행하면 신뢰도 역시 어느정도 확보할 수 있다.\", _jsx(_components.br, {}), \"\\n\", \"예로 들어 서로 다른 해시함수 100개를 적용한다면, 시그니처의 길이가 100으로 결정되는데, 이 길이는 충분히 신뢰도를 확보할 수 있을 것이다.\", _jsx(_components.br, {}), \"\\n\", \"즉, 42억개에서 100개로 압축되는 효과가 발생하는 것이다.\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"위의 사진을 예시로 실제 Jaccard 유사도와 시그니처 유사도를 비교해보며 시그니처 길이가 신뢰도에 어느정도 영향을 주는지 알아보자.\"\n    }), \"\\n\", _jsxs(_components.blockquote, {\n      children: [\"\\n\", _jsxs(_components.p, {\n        children: [\"Column 1, 2\", _jsx(_components.br, {}), \"\\n\", \"Jaccard Similarity: \", _jsx(_components.strong, {\n          children: \"1/4\"\n        }), _jsx(_components.br, {}), \"\\n\", \"Singature Similarity: \", _jsx(_components.strong, {\n          children: \"1/3\"\n        })]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"Column 2, 3\", _jsx(_components.br, {}), \"\\n\", \"Jaccard Similarity: \", _jsx(_components.strong, {\n          children: \"1/5\"\n        }), _jsx(_components.br, {}), \"\\n\", \"Singature Similarity: \", _jsx(_components.strong, {\n          children: \"1/3\"\n        })]\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [\"Column 3, 4\", _jsx(_components.br, {}), \"\\n\", \"Jaccard Similarity: \", _jsx(_components.strong, {\n          children: \"1/5\"\n        }), _jsx(_components.br, {}), \"\\n\", \"Singature Similarity: \", _jsx(_components.strong, {\n          children: \"0\"\n        })]\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.h3, {\n      id: \"implement\",\n      children: [_jsx(_components.a, {\n        className: \"anchor\",\n        href: \"#implement\",\n        children: _jsx(_components.span, {\n          className: \"icon icon-link\"\n        })\n      }), \"implement\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"의사코드로 구현해보고 시그니처 생성과정을 살펴보자.\"\n    }), \"\\n\", _jsx(_components.div, {\n      className: \"rehype-code-title\",\n      children: \"의사코드\"\n    }), _jsx(_components.pre, {\n      className: \"language-cpp\",\n      children: _jsxs(_components.code, {\n        className: \"language-cpp code-highlight\",\n        children: [_jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"// 처음에 무한대로 초기화\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"all i \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"and\"\n          }), \" c\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"M\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" c\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" inf\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \"\\n\"]\n        }), _jsx(_components.span, {\n          className: \"code-line\",\n          children: \"\\n\"\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token comment\",\n            children: \"// 각 행에 대해 반복하는데, 여기에 탐색개수 50개와 같은 제한을 걸 수 있음\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"each row r\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"each hash function h_i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    compute \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"h_i\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"r\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"each column c\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"// 탐색지점에 1이 있는 경우\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"c has \", _jsx(_components.span, {\n            className: \"token number\",\n            children: \"1\"\n          }), \" in row r\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"      \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"for\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"each hash function h_1\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token comment\",\n            children: \"// 저장된 시그니처보다 새 탐색값이 작은 경우에만 업데이트\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token keyword\",\n            children: \"if\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), _jsx(_components.span, {\n            className: \"token function\",\n            children: \"h_i\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"r\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" is smaller them \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"M\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" c\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"{\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"          \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"M\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"i\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \",\"\n          }), \" c\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token operator\",\n            children: \"=\"\n          }), \" \", _jsx(_components.span, {\n            className: \"token function\",\n            children: \"h_i\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"(\"\n          }), \"r\", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \")\"\n          }), _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \";\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"        \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"      \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"    \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [\"  \", _jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        }), _jsxs(_components.span, {\n          className: \"code-line\",\n          children: [_jsx(_components.span, {\n            className: \"token punctuation\",\n            children: \"}\"\n          }), \"\\n\"]\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/posts/mid_05/231021-001859.png\",\n        alt: \"231021-001859\"\n      })\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}},"toc":[{"slug":"jaccard-similarity","text":"Jaccard Similarity","subSections":[]},{"slug":"shingling","text":"Shingling","subSections":[{"slug":"tokens","text":"Tokens"}]},{"slug":"minhashing","text":"Minhashing","subSections":[{"slug":"permute-the-rows","text":"Permute the rows"},{"slug":"create-signature","text":"Create signature"},{"slug":"implement","text":"implement"}]}]},"__N_SSG":true},"page":"/blog/[...slugs]","query":{"slugs":["univ_mmds","mid_05"]},"buildId":"rqj0U5_GhQD4-JilT3-oa","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>